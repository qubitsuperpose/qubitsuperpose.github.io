---
title: 2차시 2:QC - Math and Theory2
layout: single
classes: wide
categories:
  - Math 
  - Theory
toc: true # 이 포스트에서 목차를 활성화
toc_sticky: true # 목차를 고정할지 여부 (선택 사항)
---

- 출처: [www.quantumsoar.com](https://www.quantumsoar.com)

## 2.01 수학적 표현
### 1. 텐서 곱
이 과정의 첫 번째 섹션을 완료하신 것을 축하드립니다. 이제 양자 컴퓨터 과학자가 되는 데 한 걸음 더 다가섰습니다! 이 섹션에서는 여러 큐비트를 사용하는 방법을 소개합니다.

우리는 텐서곱($\otimes$)이라는 것을 사용하여, 여러 큐비트를 표현합니다. 두개의 큐비트를 가진 예를 살펴보겠습니다.
$\|\psi_{0}\rangle = \alpha\|0\rangle + \beta\|1\rangle$ and 
$\|\psi_{1}\rangle = \gamma\|0\rangle + \delta\|1\rangle$ :

$\|\psi_{0}\rangle \otimes \|\psi_{1}\rangle = (\alpha\|0\rangle + \beta\|1\rangle) \otimes (\gamma\|0\rangle + \delta\|1\rangle)$ \
$= (\alpha|0\rangle)\otimes(\gamma\|0\rangle) + (\alpha\|0\rangle)\otimes(\delta|1\rangle) + (\beta|1\rangle)\otimes(\gamma\|0\rangle) + (\beta\|1\rangle)\otimes(\delta|1\rangle)$ \
$= (\alpha\gamma \|0\rangle \otimes \|0\rangle) + (\alpha\delta \|0\rangle \otimes \|1\rangle) + (\beta\gamma \|1\rangle \otimes \|0\rangle) + (\beta\delta \|1\rangle \otimes \|1\rangle)$ 

$\|x_{1}\rangle \otimes \|x_{2}\rangle$ 를 다음과 같이 단순화 할 수 있다. $\|x_{1}\rangle\|x_{2}\rangle$ 또는 $\|x_{1}x_{2}\rangle$ 

$= \alpha\gamma \|00\rangle + \alpha\delta \|01\rangle + \beta\gamma \|10\rangle + \beta\delta \|11\rangle$ 

간단하고 좋네요! 괄호를 평소처럼 확장하고, 상태의 진폭을 곱하고, 기저 상태의 텐서곱을 구하면 됩니다.
  - 텐서 곱은 상태를 결합하는 데도 쓰이지만, 그 상태에 국소적인 연산을 가하는 연산자를 구성하는 데도 필수적으로 사용
    

### 2. 텐서 곱 예제
이제 두 큐비트의 텐서 곱을 구하는 예를 살펴보겠습니다.

$( \frac{1}{\sqrt{2}} \|0\rangle + \frac{1}{\sqrt{2}} \|1\rangle ) \otimes ( \frac{\sqrt{3}}{2} \|0\rangle + \frac{1}{2} \|1\rangle )$ \
$= (\frac{1}{\sqrt{2}}  \frac{\sqrt{3}}{2} \, \|0\rangle \otimes \|0\rangle) + (\frac{1}{\sqrt{2}} \frac{1}{2} \, \|0\rangle \otimes \|1\rangle) $ \
$+ (\frac{1}{\sqrt{2}} \frac{\sqrt{3}}{2} \, \|1\rangle \otimes \|0\rangle) + (\frac{1}{\sqrt{2}}  \frac{1}{2} \, \|1\rangle \otimes \|1\rangle) $ \
$= \frac{\sqrt{3}}{2\sqrt{2}} \|00\rangle + \frac{1}{2\sqrt{2}} \|01\rangle + \frac{\sqrt{3}}{2\sqrt{2}} \|10\rangle + \frac{1}{2\sqrt{2}} \|11\rangle$

> 다음 사항을 평가하시오. \
$(\frac{1}{\sqrt{10}}\|0\rangle + \frac{3}{\sqrt{10}}\|1\rangle) \otimes (\frac{1}{\sqrt{2}}\|0\rangle + \frac{1}{\sqrt{2}}\|1\rangle)$ 
>
답: $\frac{1}{2\sqrt{5}}\|00\rangle + \frac{1}{2\sqrt{5}}\|01\rangle + \frac{3}{2\sqrt{5}}\|10\rangle + \frac{3}{2\sqrt{5}}\|11\rangle$

### 3.다중 큐비트를 사용한 확률
큐비트가 하나인 경우와 동일한 과정을 통해 측정 확률을 구할 수 있습니다. 즉, 절대값을 취하고 기저 상태의 진폭을 제곱하는 것입니다. 다음은 큐비트가 두 개인 경우의 예입니다.

$\|\psi\rangle = \frac{\sqrt{3}}{2\sqrt{2}}\|00\rangle + \frac{1}{2\sqrt{2}}\|01\rangle + \frac{\sqrt{3}}{2\sqrt{2}}\|10\rangle + \frac{1}{2\sqrt{2}}\|11\rangle$

00 측정확률은 $\|\frac{\sqrt{3}}{2\sqrt{2}}\|^2 = \frac{3}{8}$ \
01 측정확률은 $\|\frac{\sqrt{1}}{2\sqrt{2}}\|^2 = \frac{1}{8}$ \
10 측정확률은 $\|\frac{\sqrt{3}}{2\sqrt{2}}\|^2 = \frac{3}{8}$ \
11 측정확률은 $\|\frac{\sqrt{1}}{2\sqrt{2}}\|^2 = \frac{1}{8}$

> 10의 측정확률은 ? \
$\frac{1}{2\sqrt{5}}\|00\rangle + e^{\pi{i}/2}\frac{1}{2\sqrt{5}}\|01\rangle + e^{3\pi{i}/2}\frac{3}{2\sqrt{5}}\|10\rangle + \frac{3}{2\sqrt{5}}\|11\rangle$
> 
답: $\|e^{3\pi{i}/2}\frac{3}{2\sqrt{5}}\|^2 =\|e^{3\pi{i}/2}\|^2\|\frac{3}{2\sqrt{5}}\|^2 = \|1\|^2\|\frac{3}{2\sqrt{5}}\|^2 = \frac{9}{20}$

### 4.큐비트 추가!
텐서 곱을 사용하면 이제 상태에 원하는 만큼의 큐비트를 추가할 수 있습니다. 큐비트를 상태에 텐서하기만 하면 됩니다!
이전 섹션의 $\|\psi\rangle$ 에 $\|\phi\rangle = \frac{4}{5}\|0\rangle + e^{i\pi}\frac{3}{5}\|1\rangle$ 를 추가하는 예제가 있다.

$\|\psi\rangle\|\phi\rangle = (\frac{\sqrt{3}}{2\sqrt{2}}\|00\rangle + \frac{1}{2\sqrt{2}}\|01\rangle + \frac{\sqrt{3}}{2\sqrt{2}}\|10\rangle + \frac{1}{2\sqrt{2}}\|11\rangle) (\frac{4}{5}\|0\rangle + e^{i\pi}\frac{3}{5}\|1\rangle)$ \
$= \frac{2\sqrt{3}}{5\sqrt{2}}\|000\rangle + \frac{2}{5\sqrt{2}}\|010\rangle + \frac{2\sqrt{3}}{5\sqrt{2}}\|100\rangle + \frac{2}{5\sqrt{2}}\|110\rangle$ \
$+ e^{i\pi}\frac{3\sqrt{3}}{10\sqrt{2}}\|001\rangle + e^{i\pi}\frac{3}{10\sqrt{2}}\|011\rangle$ \
$+ e^{i\pi}\frac{3\sqrt{3}}{10\sqrt{2}}\|101\rangle + e^{i\pi}\frac{3}{10\sqrt{2}}\|111\rangle$

측정은 동일하다. 000의 측정확률은 $\|\frac{2\sqrt{3}}{5\sqrt{2}}\|^2 = \frac{6}{25}$

### 5. 추가적인 표기법
상태가 $\|xxx\rangle = \|x\rangle \otimes \|x\rangle \otimes \|x\rangle$ 라고 할 때, 일반적으로 이를 $\|x\rangle^{\otimes {3}}$ 으로 표기합니다. 다음은 몆가지 예입니다.

$\|0\rangle^{\otimes{5}} = \|00000\rangle$ \
$\|1\rangle^{\otimes{8}} = \|11111111\rangle$

$\|+\rangle^{\otimes{2}} = \|++\rangle = [\frac{1}{\sqrt{2}}(\|0\rangle +\|1\rangle)] \otimes [\frac{1}{\sqrt{2}}(\|0\rangle +\|1\rangle)] $

> 상태 $\|-\rangle^{\otimes{2}}$ 는 무엇과 같은가요? 
>
> 답: $\|-\rangle^{\otimes{2}} = \|-\rangle \otimes \|-\rangle = \frac{1}{\sqrt{2}}(\|0\rangle -\|1\rangle) \otimes \frac{1}{\sqrt{2}}(\|0\rangle -\|1\rangle) $ \
$= \frac{1}{2}(\|00\rangle - \|01\rangle - \|10\rangle + \|11\rangle)$


### 6. 연습문제
문제1. $\|\psi_{0}\rangle = \alpha\|0\rangle + \beta\|1\rangle$ 와
$\|\psi_{1}\rangle = \gamma\|0\rangle + \delta\|1\rangle$ 의 텐서곱은?
> 답:$\|\psi_{0}\rangle \otimes \|\psi_{1}\rangle = \alpha\gamma \|00\rangle + \alpha\delta \|01\rangle + \beta\gamma \|10\rangle + \beta\delta \|11\rangle$ 

문제2. 2큐비트 상태를 고려해보면: $\|\psi\rangle = \frac{\sqrt{3}}{2}\|00\rangle + \frac{1}{2\sqrt{3}}\|01\rangle + \frac{1}{2\sqrt{3}}\|10\rangle + \frac{1}{2\sqrt{3}}\|11\rangle$ \
각 기저의 $\|00\rangle, \|01\rangle, \|10\rangle, \|11\rangle$ 측정확률을 구하시요.
> 답: 00 측정확률은 $\|\frac{\sqrt{3}}{2}\|^2 = \frac{3}{4}$ \
01 측정확률은 $\|\frac{1}{2\sqrt{3}}\|^2 = \frac{1}{12}$ \
10 측정확률은 $\|\frac{1}{2\sqrt{3}}\|^2 = \frac{1}{12}$ \
11 측정확률은 $\|\frac{1}{2\sqrt{3}}\|^2 = \frac{1}{12}$

문제3. 큐비트 $\|\psi\rangle = \|+\rangle \otimes \|-\rangle$ 상태를 계산 기저로 확장하세요.
> 답: $\|\psi\rangle = \frac{1}{2}(\|00\rangle + \|01\rangle  + \|10\rangle  + \|11\rangle )$

문제4. $\|+\rangle \otimes \|+\rangle \otimes \|+\rangle$에 대한 약식 표기법은?
> 답: $\|+++\rangle = \|+\rangle^{\otimes{3}}$

문제5. $\|\psi\rangle = \frac{1}{\sqrt{3}}\|00\rangle + \sqrt{\frac{2}{3}}\|11\rangle$ 상태에 대하여, $\|11\rangle$에 대한 측정확률은?
> 답: $P(\|11\rangle) = \|\sqrt{\frac{2}{3}}\|^2 = 2/3$

문제6. $\|\psi\rangle = \|0\rangle \otimes \|+\rangle $ 상태에 대해 계산 기저로 확장하고, $\|01\rangle$에 대한 측정확률은?
> 답:  $\|\psi\rangle = \|0\rangle \otimes \frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle) = \frac{1}{\sqrt{2}}(\|00\rangle + \|01\rangle)$ \
$P(\|01\rangle) = \|\frac{1}{\sqrt{2}}\|^2 = 1/2$

## 2.02 양자 회로와 다중 큐비트 게이트

### 1. 다중 큐비트 상태에 단일 큐비트 게이트 적용
단일 큐비트 게이트를 다중 큐비트 상태에 적용할 때, 각 중첩 상태의 특정 큐비트에 해당 게이트를 적용합니다. 아래 예에서는 중간(왼쪽에서 두번째) 큐비트에 X 게이트를 적용하고, 각 중첩 상태에서는 상태의 각 항의 중간 원소에만 X 게이트를 적용합니다.

$X_2 \|\psi\rangle = X_2 ( \frac{1}{\sqrt{3}} \|001\rangle + \frac{1}{\sqrt{3}} \|010\rangle + \frac{1}{\sqrt{3}} \|111\rangle)$ \
$= \frac{1}{\sqrt{3}} X_2\|001\rangle + \frac{1}{\sqrt{3}} X_2\|010\rangle + \frac{1}{\sqrt{3}} X_2\|111\rangle$ \
$= \frac{1}{\sqrt{3}} \|0\rangle X \|0\rangle\|1\rangle + \frac{1}{\sqrt{3}} \|0\rangle X \|1\rangle\|0\rangle + \frac{1}{\sqrt{3}} \|1\rangle X \|1\rangle \|1\rangle$ \
$= \frac{1}{\sqrt{3}} \|011\rangle + \frac{1}{\sqrt{3}} \|000\rangle + \frac{1}{\sqrt{3}} \|101\rangle$

> 3큐비트 상태 $\frac{1}{\sqrt{3}}\|001\rangle + \frac{1}{\sqrt{3}}\|010\rangle + \frac{1}{\sqrt{3}}\|111\rangle$의 가장 오른쪽 큐비트에 $Z$ 게이트를 적용하면 
>
> 답: $Z_3 \|\psi\rangle = Z_3 ( \frac{1}{\sqrt{3}} \|001\rangle + \frac{1}{\sqrt{3}} \|010\rangle + \frac{1}{\sqrt{3}} \|111\rangle)$ \
$= \frac{1}{\sqrt{3}} Z_3\|001\rangle + \frac{1}{\sqrt{3}} Z_3\|010\rangle + \frac{1}{\sqrt{3}} Z_3\|111\rangle$ \
$= \frac{1}{\sqrt{3}} \|00\rangle Z \|1\rangle + \frac{1}{\sqrt{3}} \|01\rangle Z \|0\rangle + \frac{1}{\sqrt{3}} \|11\rangle Z \|1\rangle$ \
$= -\frac{1}{\sqrt{3}} \|001\rangle + \frac{1}{\sqrt{3}} \|010\rangle - \frac{1}{\sqrt{3}} \|111\rangle$

### 2. 양자 회로
게이트가 적용되는 큐비트를 나타내는 데 아래 첨자 표기법을 사용하는 것은 번거로울 수 있습니다. 대신 일반적으로 양자 회로라는 것을 사용합니다. 예를 들어 다음과 같습니다.

<img src="https://www.quantumsoar.com/_app/immutable/assets/quantum_circuit_example.D6hRQDSV.png" width="400">

양자 회로를 오른쪽에서 왼쪽으로 읽습니다. 각 줄은 큐비트 레지스터(이 경우 각 줄은 단일 큐비트)를 나타내고, 왼쪽의 상태는 큐비트의 초기 상태를 나타냅니다. 회로의 상자는 게이트이며, 게이트가 위치한 줄은 게이트가 적용되는 큐비트를 나타냅니다. 게이트는 왼쪽에서 오른쪽으로 적용합니다. 이 회로를 살펴보겠습니다!

### 3. 양자 회로 예제


<img src="https://www.quantumsoar.com/_app/immutable/assets/quantum_circuit_example.D6hRQDSV.png" width="400">

$\|\psi_{0}\rangle = \|0\rangle\|0\rangle\|1\rangle$ \
$\|\psi_{1}\rangle = \|0\rangle X \|0\rangle\|1\rangle = \|0\rangle\|1\rangle\|1\rangle$ \
$\|\psi_{2}\rangle = \|0\rangle H \|1\rangle\|1\rangle = \|0\rangle\|-\rangle\|1\rangle$ \
$\|\psi_{3}\rangle = X \|0\rangle \|-\rangle X \|1\rangle = \|1\rangle\|-\rangle\|0\rangle$ \
$= |1\rangle \left( \frac{|0\rangle - |1\rangle}{\sqrt{2}} \right) |0\rangle 
= \frac{1}{\sqrt{2}} \left( |1\rangle |0\rangle |0\rangle - |1\rangle |1\rangle |0\rangle \right) 
= \frac{1}{\sqrt{2}} \left( |100\rangle - |110\rangle \right)$

회로의 끝 게이트들은 측정값이며, 회로의 끝에서 세 개의 큐비트를 모두 측정한다는 것을 나타냅니다.

> 다음 양자회로의 마지막 상태는 무엇인가?\
<img src="https://www.quantumsoar.com/_app/immutable/assets/circuit_question.Bl-a_Gl2.png" width="200">

> 답: $\|\psi_0\rangle = \|10\rangle$ \
$\|\psi_1\rangle = H\|1\rangle \, X\|0\rangle = \|-\rangle \|1\rangle = \frac{1}{\sqrt{2}} \bigl( \|0\rangle - |1\rangle \bigr) \|1\rangle$ \
$\|\psi_2\rangle = Z \left[ \frac{1}{\sqrt{2}} \bigl( \|0\rangle - \|1\rangle \bigr) \right] \|1\rangle$ \
$= \frac{1}{\sqrt{2}} \bigl( Z\|0\rangle - Z\|1\rangle \bigr) \|1\rangle$ \
$= \frac{1}{\sqrt{2}} \bigl( \|0\rangle + \|1\rangle \bigr) \|1\rangle = \|+\rangle \|1\rangle $ \
$\|\psi_3\rangle = H \|+\rangle \, \|1\rangle = \|0\rangle \|1\rangle = \|01\rangle$


### 4. CNOT/제어-X 게이트
이제 CNOT 또는 제어-x 게이트부터 시작하여 몇 가지 다중 큐비트 게이트를 소개하겠습니다. 이 게이트는 두 큐비트에 작용하는데, 하나는 제어 큐비트이고 다른 하나는 대상 큐비트입니다. 제어 큐비트가 1이면 대상 큐비트에 X 게이트가 적용됩니다. 제어큐비트가 0이면 상태는 그대로 유지됩니다.

아래는 CNOT 게이트를 표현하는 방법으로, $\|\psi_{0}\rangle$을 타겟 큐비트로, $\|\psi_{1}\rangle$을 제어 큐비트 설정.
<img src="https://www.quantumsoar.com/_app/immutable/assets/circuit_cnot.BsXlRGUa.png" width="400">

왼쪽 큐비트를 제어로 중간 큐비트를 대상으로 설정하여, $\frac{1}{\sqrt{2}}\|010\rangle + \frac{1}{\sqrt{2}}\|100\rangle$ 상태에 CNOT 게이트를 적용하자.

$$\text{CNOT}_{1,2} ( \frac{1}{\sqrt{2}} |010\rangle + \frac{1}{\sqrt{2}} |100\rangle )$$ \
$$= \frac{1}{\sqrt{2}} \text{CNOT}_{1,2} |010\rangle + \frac{1}{\sqrt{2}} \text{CNOT}_{1,2} |100\rangle$$ \
$= \frac{1}{\sqrt{2}} \|010\rangle + \frac{1}{\sqrt{2}} \|1\rangle X\|0\rangle \|0\rangle$ \
$= \frac{1}{\sqrt{2}} \|010\rangle + \frac{1}{\sqrt{2}} \|110\rangle$

첫번째 항은 제어 큐비트가 0이기 때문에 변경사항이 없지만, 두번째 항은 제어 큐비트가 1이기 때문에 X 게이트가 적용된다.

> 다음 상태에 오른쪽 큐비트를 제어 큐비트로, 왼쪽 큐비트를 목표로 하여 CNOT 게이트를 적용합니다.
$\frac{1}{\sqrt{3}}\|00\rangle - \frac{1}{\sqrt{3}}\|10\rangle + \frac{1}{\sqrt{3}}\|11\rangle$
> 
> 답: $\frac{1}{\sqrt{3}}\|00\rangle - \frac{1}{\sqrt{3}}\|10\rangle + \frac{1}{\sqrt{3}}\|01\rangle$

### 5. 토폴리 게이트
TOFFOLI 게이트는 CNOT 게이트와 동일하지만, 컨트롤이 하나가 아닌 두 개입니다. 두 컨트롤이 모두 1이면 X 게이트가 대상에 적용되고, 그렇지 않으면 아무 동작도 수행되지 않습니다.

다음은 TOFFOLI 게이트가 큐비트 $\|\psi_{0}\rangle$ 를 대상으로 하고 큐비트$\|\psi_{1}\rangle$,$\|\psi_{2}\rangle$를 컨트롤로 사용하여 표현한 방법입니다.

<img src="https://www.quantumsoar.com/_app/immutable/assets/circuit_toffoli.SKFa8kv0.png" width="400">

다음은 왼쪽 큐비트와 중간 큐비트를 제어로 설정하고, 우측 큐비트를 대상으로 하여 상태 $\frac{1}{\sqrt{3}}\|001\rangle + \frac{1}{\sqrt{3}}\|101\rangle + \frac{1}{\sqrt{3}}\|111\rangle$ 에 적용한 토폴리 게이트입니다.

$$\text{TOFFOLI}_{1,2,3} ( \frac{1}{\sqrt{3}} |001\rangle + \frac{1}{\sqrt{3}} |101\rangle ) + \frac{1}{\sqrt{3}} |111\rangle )$$ \
$$= \frac{1}{\sqrt{3}} \text{TOFFOLI}_{1,2,3} |001\rangle + \frac{1}{\sqrt{3}} \text{TOFFOLI}_{1,2,3} |101\rangle + \text{TOFFOLI}_{1,2,3} |111\rangle$$ \
$= \frac{1}{\sqrt{3}} \|001\rangle + \frac{1}{\sqrt{3}} \|101\rangle + \frac{1}{\sqrt{3}} \|110\rangle$

보시다시피, 상태의 처음 두 항은 컨트롤이 모두 1이 아니기 때문에 변경되지 않습니다. 그러나 세 번째 항은 컨트롤이 모두 1이므로 X 게이트가 적용됩니다.

> 왼쪽 큐비트와 중간 큐비트를 제어로 설정하고, 우측 큐비트를 대상으로 하여 상태 $\frac{1}{\sqrt{3}}\|000\rangle - \frac{1}{\sqrt{3}}\|100\rangle + \frac{1}{\sqrt{3}}\|111\rangle$ 에  토폴리 게이트를 적용하시오.
> 
> 답: $\frac{1}{\sqrt{3}}\|000\rangle - \frac{1}{\sqrt{3}}\|100\rangle + \frac{1}{\sqrt{3}}\|110\rangle$


### 6.제어 게이트
제어 Y, 제어 Z, 제어 S, 제어 T, 제어 H 등을 포함한 모든 일반 게이트의 제어 버전도 있습니다. 모든 양자 게이트에는 제어 버전이 있습니다.이 버전은 CNOT 게이트와 동일하게 작동하며, 제어 값이 1이면 게이트를 대상에 적용합니다.

아래는 양자 회로의 제어 Z 게이트입니다. 보시다시피 제어 큐비트로 연결되는 선이 있는 일반 Z 게이트입니다. 양자 회로에서 제어 X 또는 CNOT를 제외한 모든 제어 게이트는 제어로 연결되는 선이 있는 일반 게이트입니다. 아래 상태에서는 ​제어 큐비트 $\|\psi_{1}\rangle$ 1이면 Z 게이트가 대상 큐비트 $\|\psi_{0}\rangle$에 적용됩니다, CNOT과 같습니다.

<img src="https://www.quantumsoar.com/_app/immutable/assets/circuit_controlled.CK4eplh6.png" width="400">

> 다음 회로의 결과는?
<img src="https://www.quantumsoar.com/_app/immutable/assets/circuit_controlled_question.SH_cduEt.png" width="200">

> 답: $\|\psi_{0}\rangle=\|00\rangle$ \
$\|\psi_{1}\rangle=\|01\rangle$ \
$\|\psi_{2}\rangle$ 에서 제어 큐비트(우측 큐비트)가 1이면 대상 큐비트(좌측 큐비트)에 아다마드 게이트를 적용한다. \
$\|\psi_{2}\rangle= H\|0\rangle\|1\rangle = \|+\rangle\|1\rangle = \frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle)\|1\rangle = \frac{1}{\sqrt{2}}(\|01\rangle + \|11\rangle)$

### 7. SWAP 게이트
SWAP 게이트는 입력된 두 큐비트 $\vert q_1 \rangle$와 $\vert q_2 \rangle$의 상태를 **완전히 맞바꿉니다**.

만약 초기 상태가 $\vert \psi \rangle = \vert q_1 q_2 \rangle$라면, SWAP 게이트를 적용한 후의 최종 상태는 $\vert \psi' \rangle = \vert q_2 q_1 \rangle$가 됩니다.

* **예시:**
    * $\text{SWAP} \vert 01 \rangle = \vert 10 \rangle$
    * $\text{SWAP} \vert 10 \rangle = \vert 01 \rangle$
    * $\text{SWAP} \vert 00 \rangle = \vert 00 \rangle$
    * $\text{SWAP} \vert 11 \rangle = \vert 11 \rangle$

* 양자 회로에서의 역할
  * **연결성 (Connectivity):** 실제 양자 하드웨어(예: 초전도 큐비트)에서는 모든 큐비트 쌍이 직접 상호작용할 수 없고, 특정 이웃 큐비트끼리만 상호작용할 수 있도록 물리적 제약이 따릅니다.
  * **큐비트 라우팅:** 만약 큐비트 $A$와 $C$ 사이에 CNOT 게이트를 적용해야 하는데, $A$와 $C$가 멀리 떨어져 있고 $B$가 중간에 있다면, $A$와 $B$, $B$와 $C$의 순서로 SWAP 게이트를 적용하여 $A$를 $C$의 이웃으로 이동시켜야 합니다. 이 과정을 **큐비트 라우팅(Qubit Routing)**이라고 합니다. 
* 분해 (Decomposition): SWAP 게이트는 기본 게이트인 **CNOT 게이트 3개를 연속**으로 사용하여 구현. $\text{SWAP} =$ $$\text{CNOT}_{1,2} \cdot \text{CNOT}_{2,1} \cdot \text{CNOT}_{1,2}$$

### 8. 연습문제
문제1. 초기 상태 $\|\psi\rangle = \|001\rangle$ 을 고려하여, 중간 큐비트에 $X$게이트를 적용하면?
> 답: $\|\psi_{1} = \|0\rangle X \|0\rangle\|1\rangle = \|011\rangle$

문제2. 다음 상태 $\|\psi\rangle = \frac{1}{3}\|001\rangle + \frac{1}{3}\|010\rangle + \frac{1}{3}\|111\rangle$ 의 중간 큐비트에 $X$ 게이트를 적용하면, 결과는?
> 답: $X_{2}\|\psi\rangle = \frac{1}{3}\|011\rangle + \frac{1}{3}\|000\rangle + \frac{1}{3}\|101\rangle$

문제3. 상태 $\|\psi\rangle = \|011\rangle$ 의 첫번재 큐비트에 $H$ 게이트를 적용하라.
> 답: $H_{1} \|011\rangle = \frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle) \otimes \|11\rangle = \frac{1}{\sqrt{2}}(\|011\rangle + \|111\rangle)$

문제4. 상태 $\|\psi\rangle = \|011\rangle$ 의 두번재 큐비트에 $H$ 게이트를 적용하라.
> 답: $\|\psi_{2}\rangle = \|0\rangle H \|1\rangle\|1\rangle = \|0\rangle\|-\rangle\|1\rangle = \frac{1}{\sqrt{2}}(\|001\rangle - \|011\rangle$


문제5. $\|+\rangle\|-\rangle\|1\rangle$ 을 모든 기저 상태의 중첩으로 표현하시오.
> 답: $\|\psi\rangle = \frac{1}{2}(\|001\rangle - \|011\rangle + \|101\rangle - \|111\rangle$

문제6. 상태 $\|01\rangle + \|10\rangle$ 에서 첫번째 큐비트를 제어 큐비트로, 두번째 큐비트를 대상 큐비트로 설정하는 $\text{CNOT}$ 게이트를 적용하면?
> 답변: $\text{CNOT}_{1,2}\bigl(\frac{1}{2}(\|01\rangle + \|10\rangle)\bigr) = \frac{1}{2}(\|01\rangle + \|11\rangle)$

문제7. 이전 질문에서 CNOT 게이트를 적용한 후에도 첫 번째 항 ∣010⟩이 변경되지 않는 이유를 설명하세요.
> 답: 제어 큐비트(첫 번째 큐비트)가 $\|0\rangle$ 이므로 대상 큐비트는 뒤집히지 않고 상태는 변경되지 않습니다.

문제8. 상태 $\frac{1}{2}(\|000\rangle + \|001\rangle + \|010\rangle + \|111\rangle)$ 에 두번째 큐비트가 제어 큐비트, 세번째 큐비트가 대상 큐비트인 CNOT 게이트를 적용하면?
> 답: $CNOT_{2,3}(\frac{1}{2}(\|000\rangle + \|001\rangle + \|010\rangle + \|111\rangle)) = \frac{1}{2}(\|000\rangle + \|001\rangle + \|011\rangle + \|110\rangle)$

문제9. 상태 $\frac{1}{3}(\|001\rangle + \|101\rangle + \|111\rangle)$ 에 제어 큐비트로 첫번째, 두번째 큐비트, 대상 큐비트로 세번째 큐비트로 하는 TOFFOLI 게이트를 적용하면?
> 답: $TOFFOLI_{1,2,3}(\frac{1}{3}(\|001\rangle + \|101\rangle + \|111\rangle)) = \frac{1}{3}(\|001\rangle + \|101\rangle + \|110\rangle)$


<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Quantum_Logic_Gates.png/1000px-Quantum_Logic_Gates.png" style="width:70%">

## 2.03 단일 큐비트 측정
### 1. 다중 큐비트 상태에서 단일 큐비트 측정 확률
다음과 같은 두 큐비트 상태가 있다고 가정해 보겠습니다.

$\|\psi\rangle = \frac{1}{2}\|00\rangle + \frac{1}{4}\|01\rangle + \frac{e^{i\pi/2}}{\sqrt{2}}\|10\rangle + \frac{\sqrt{3}}{4}\|11\rangle$

두 번째 큐비트를 1로 측정할 확률은 얼마입니까?
1로 측정하는 것은 매우 간단합니다. 두 번째 위치에 1이 있는 모든 상태의 확률을 모두 더하면 됩니다.

두 번째 큐비트를 1로 측정할 확률은  01을 측정할 확률과 11을 측정할 확률의 합입니다. \
$= \|\frac{1}{4}\|^2 + \|\frac{\sqrt{3}}{4}\|^2 = \frac{1}{4}$

> 다음 3큐비트 상태에서 첫 번째 큐비트를 0으로 측정할 확률은 얼마입니까? $\|\psi\rangle = \frac{1}{\sqrt{3}}(\|001\rangle + \|010\rangle + \|111\rangle)$ \
답: 2/3

### 2. 다중 큐비트 상태 붕괴
이제 다중 큐비트 상태에서 단일 큐비트를 측정할 확률을 알게 되었습니다. 그렇다면 다중 큐비트 상태에서 단일 큐비트를 측정한다면 그 상태는 어떻게 붕괴될까요? 큐비트를 측정할 때 그 상태가 측정 대상이 된다는 것을 알고 있습니다. 그렇다면 다중 큐비트 상태는 어떻게 붕괴될까요?

이를 보여주기 위해 다음 상태를 예로 들어 보겠습니다: \
$\|\psi\rangle = \frac{1}{2}\|00\rangle + \frac{1}{4}\|01\rangle + \frac{e^{i\pi/2}}{\sqrt{2}}\|10\rangle + \frac{\sqrt{3}}{4}\|11\rangle$ 

이 예에서 두 번째 큐비트를 1로 측정한다고 가정해 보겠습니다. 두 번째 큐비트를 1로 측정했으므로 두 번째 큐비트의 상태는 ∣1⟩가 됩니다. 이는 큐비트 방정식에서 두 번째 위치에 0이 있는 모든 기저 상태를 제거한다는 것을 의미합니다. 

$\|\psi_{0}\rangle = \frac{1}{2}\|00\rangle + \frac{1}{4}\|01\rangle + \frac{e^{i\pi/2}}{\sqrt{2}}\|10\rangle + \frac{\sqrt{3}}{4}\|11\rangle $ \
$\Longrightarrow \frac{1}{4}\|01\rangle  + \frac{\sqrt{3}}{4}\|11\rangle$

이제 모든 확률의 합은 1이어야 하므로 상태를 재정규화해야 합니다. 왜냐하면 $\|\frac{1}{4}\|^2 + \|\frac{\sqrt{3}}{4}\|^2 \neq 1$ 입니다. 이를 위해 상태에 정규화 상수 A를 곱하고, 항등식을 사용하여 모든 확률의 합은 1이어야 함을 해결할 수 있습니다.

$\|\psi_{1}\rangle = A(\frac{1}{4}\|01\rangle  + \frac{\sqrt{3}}{4}\|11\rangle) = \frac{A}{4}\|01\rangle  + \frac{A\sqrt{3}}{4}\|11\rangle$  \
$\Longrightarrow \|\frac{A}{4}\|^2  + \|\frac{A\sqrt{3}}{4}\|^2 = 1 \Longrightarrow \frac{A^2}{16} + \frac{3A^2}{16} = 1 $ \
$\Longrightarrow 4A^2 = 16 \Longrightarrow A^2 = 4 \Longrightarrow A= \pm 2$

이제 A=±2이므로 상태에 곱하여 상태를 정규화할 수 있습니다( A=2를 취합니다. 왜냐하면, A=−2를 취하면 전역 위상 $-1 = e^{i\pi}$이 이므로 결국 동일한 상태가 됩니다).

$\|\psi_{2}\rangle = 2(\frac{1}{4}\|01\rangle  + \frac{\sqrt{3}}{4}\|11\rangle) = \frac{1}{2}\|01\rangle  + \frac{\sqrt{3}}{2}\|11\rangle$

보시다시피 가능한 모든 결과의 합은 1입니다 $\|\frac{1}{2}\|^2+ \|\frac{\sqrt{3}}{2}\|^2 = 1$. 이제 완료되었습니다.
$\|\psi_{2}\rangle$는 2번째 큐비트를 1로 측정했을 때 $\|\psi_{0}\rangle$가 붕괴되는 상태입니다.

요약하자면 이 프로세스에는 두 단계가 있습니다.
1. 측정값이 상태와 일치하지 않는 중첩 상태를 방정식에서 제거합니다.
2. 가능한 모든 측정 결과의 합이 1이 되도록 상태를 정규화합니다.

> 다음 다중 큐비트 상태에서 중간 큐비트를 1로 측정하면 무엇으로 붕괴될까요?
$\|\psi\rangle = \frac{\sqrt{2}}{2}\|000\rangle + \frac{\sqrt{2}}{4}\|001\rangle + \frac{\sqrt{5}}{4}\|110\rangle + \frac{1}{4}\|111\rangle$
> 
> 답: $A(\frac{\sqrt{5}}{4}\|110\rangle + \frac{1}{4}\|111\rangle)$ \
$\|\frac{A\sqrt{5}}{4}\|^2 + \|\frac{A}{4}\|^2 = 1 \Longrightarrow A = \pm \frac{2\sqrt{2}}{\sqrt{3}}$ \
상태는 다음으로 붕괴한다: \
$\frac{2\sqrt{2}}{\sqrt{3}}(\frac{\sqrt{5}}{4}\|110\rangle + \frac{1}{4}\|111\rangle)$ \
$= \frac{1}{2\sqrt{3}}(\sqrt{10}\|110\rangle + \sqrt{2}\|111\rangle)$


### 3. 연습문제
문제1. 두 큐비트 $\|\psi\rangle = \frac{1}{2} \|00\rangle + \frac{1}{4} \|01\rangle + \frac{1}{2}e^{i\pi/2} \|10\rangle + \frac{3}{4} \|11\rangle$를 고려하여, 두번째 큐비트가 $\|1\rangle$ 로 측정될 확률은?
> 답: 두 번째 큐비트를 ∣1⟩로 측정할 확률은 ∣01⟩과 ∣11⟩의 계수의 제곱 크기의 합입니다.\
$\|\frac{1}{4}\|^2+\|\frac{3}{4}\|^2=\frac{1}{16}+\frac{9}{16} = \frac{10}{16} = \frac{5}{8}$

문제2. 이전 질문과 동일한 상태를 사용할 때, 두 번째 큐비트를 ∣0⟩으로 측정할 확률은 얼마입니까?
> 답: 두 번째 큐비트를 ∣0⟩으로 측정할 확률은 ∣00⟩과 ∣10⟩의 계수의 제곱 크기의 합입니다. \
$\|\frac{1}{2}\|^2+\|\frac{1}{2}\|^2=\frac{1}{4}+\frac{1}{4} = \frac{2}{4} = \frac{1}{2}$

문제3. 위 상태의 두 번째 큐비트가 ∣1⟩로 측정된다면, ∣ψ⟩는 어떤 상태로 붕괴될까요?
> 답: 붕괴된 상태는 두 번째 큐비트가 ∣1⟩인 항에 비례합니다.\
$\|\psi_{collapsed}\rangle \propto \frac{1}{4}\|01\rangle + \frac{3}{4}\|11\rangle$  \
정규화를 하면, $\|\psi_{collapsed}\rangle = \frac{1}{\sqrt{10}}\|01\rangle + \frac{3}{\sqrt{10}}\|11\rangle$  

문제4. 상태 $\|\psi\rangle = \frac{1}{\sqrt{2}}\|00\rangle + \frac{1}{\sqrt{2}}\|11\rangle$ , 첫번째 큐비트가 $\|1\rangle$일 측정확률은 얼마인가?
> 답: 단지 $\|11\rangle$ 만이 첫번째 큐비트를 $\|1\rangle$로 갖는다. $\|\frac{1}{\sqrt{2}}\|^2 = 1/2$

문제5. 동일한 상태가 주어졌을 때, 첫 번째 큐비트가 ∣1⟩로 측정된다면, 붕괴된 상태는 무엇일까요?
> 답: 붕괴된 상태는 $\|\psi_{collapsed}\rangle = \|11\rangle$

문제6. 상태 $\|\psi\rangle = \frac{1}{2}\|00\rangle + \frac{1}{2}\|01\rangle + \frac{1}{2}\|10\rangle + \frac{1}{2}\|11\rangle$, 첫번째 큐비트가 $\|0\rangle$ 로 측정될 확률은?
> 답: 첫 번째 큐비트가 ∣0⟩인 것은 ∣00⟩ 과 ∣01⟩ 입니다. \
확률: $\|\frac{1}{2}\|^2+\|\frac{1}{2}\|^2=1/2$

문제7. 동일 상태에서 첫번째 큐비트가 $\|0\rangle$로 측정시, 붕괴되는 상태는?
> 답: 붕괴된 상태는 다음에 비례: $\frac{1}{2}\|00\rangle + \frac{1}{2}\|01\rangle$ \
정규화를 하면, $\|\psi_{collapsed}\rangle = \frac{1}{\sqrt{2}}\|00\rangle + \frac{1}{\sqrt{2}}\|01\rangle$

## 2.04 양자 얽힘
### 1. 얽힘 양자 회로 소개

다음 회로를 살펴보자:
<img src="https://www.quantumsoar.com/_app/immutable/assets/entanglement_circuit.CZmpka2X.png" width="400">

$\|\psi_{0}\rangle = \|00\rangle$ 

$\|\psi_{1}\rangle = H\|00\rangle = \|+\rangle\|0\rangle = \frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle) \otimes \|0\rangle = \frac{1}{\sqrt{2}}(\|00\rangle + \|10\rangle)$ 

$\|\psi_{2}\rangle = CNOT\frac{1}{\sqrt{2}}(\|00\rangle + \|10\rangle)= \frac{1}{\sqrt{2}}(CNOT\|00\rangle + CNOT\|10\rangle)= \frac{1}{\sqrt{2}}(\|00\rangle + \|11\rangle)$ 

회로가 적용된 후에는, $\|\psi_{2}\rangle =\frac{1}{\sqrt{2}}(\|00\rangle + \|11\rangle)$ 상태로 남게 된다.

이제 첫 번째 큐비트를 측정하면 이 상태가 어떻게 붕괴되는지 살펴보겠습니다.\
첫 번째 큐비트를 0으로 측정하면 상태는 ∣00⟩으로 붕괴되고, 첫 번째 큐비트를 1로 측정하면 상태는 ∣11⟩으로 붕괴됩니다. 따라서 첫 번째 큐비트를 측정하여 두 번째 큐비트의 값을 결정할 수 있습니다. 첫 번째 큐비트를 0으로 측정하면 두 번째 큐비트가 ∣0⟩ 상태에 있음을 알 수 있기 때문입니다(반대로 1의 경우도 마찬가지입니다).

따라서 한 큐비트를 측정하면 다른 큐비트의 상태를 알 수 있습니다!

### 2. 양자 얽힘 정의
큐비트를 측정하여 측정되지 않은 다른 큐비트의 상태를 파악할 수 있을 때, 다중 큐비트 상태가 얽혀 있다고 합니다. 앞서 살펴본 상태는 다음과 같습니다. $\|\psi_{2}\rangle =\frac{1}{\sqrt{2}}(\|00\rangle + \|11\rangle)$ 은 얽혀 있는데, 큐비트 중 하나를 측정하면 다른 큐비트의 값을 알 수 있기 때문입니다.

다중 큐비트 상태가 얽혀 있지 않다면, 이를 단일 큐비트 상태의 텐서 곱으로 표현할 수 있습니다.

$\frac{\sqrt{3}}{2\sqrt{5}}\|00\rangle + \frac{1}{2\sqrt{5}}\|01\rangle + \frac{\sqrt{3}}{\sqrt{5}}\|10\rangle + \frac{1}{\sqrt{5}}\|11\rangle $ \
$= (\frac{1}{\sqrt{5}}\|0\rangle + \frac{2}{\sqrt{5}}\|1\rangle) \otimes (\frac{\sqrt{3}}{2}\|0\rangle + \frac{1}{2}\|1\rangle)$

위 상태는 단일 큐비트 상태들의 텐서 곱으로 표현될 수 있으며, 이는 얽힘 상태가 아님을 의미합니다. 이를 개별 단일 큐비트 상태로 분해할 수 있다면, 각 큐비트는 서로 독립적으로 작용하며, 이는 서로 영향을 미치지 않음을 의미합니다. 반면, 상태가 얽힘 상태라면 단일 큐비트 상태들의 텐서 곱으로 표현할 수 없습니다.

$\frac{1}{\sqrt{2}}\|001\rangle + \frac{1}{2}\|101\rangle + \frac{1}{2}\|111\rangle$

보시다시피 위 상태는 단일 큐비트 상태로 인수분해될 수 없으므로 얽혀 있습니다. 인수분해될 수 없으므로, 해당 상태의 큐비트들은 서로 영향을 미치며 독립적으로 작동하지 않습니다. 즉, 얽혀 있습니다.

얽힘에는 최대 얽힘과 부분 얽힘, 두 가지 유형이 있습니다.

### 3. 최대 얽힘 큐비트
큐비트 중 하나를 측정하면 다른 큐비트의 측정값을 결정할 수 있을 때, 큐비트가 최대 얽힘 상태라고 합니다.

예를 들어, 상태 $\|\psi_{2}\rangle =\frac{1}{\sqrt{2}}(\|00\rangle + \|11\rangle)$ 는 한 큐비트를 0으로 측정하면 다른 큐비트도 0으로 측정할 수 있고, 그 반대의 경우도 마찬가지입니다. 1로 측정하면 1로 측정할 수 있습니다.

최대 얽힘의 또 다른 예는 $\|\psi\rangle =\frac{1}{\sqrt{2}}(\|01\rangle + \|10\rangle)$ \
첫 번째 큐비트를 0으로 측정하면 두 번째 큐비트가 ∣1⟩ 상태로 붕괴되었음을 알 수 있고, 첫 번째 큐비트를 1로 측정하면 두 번째 큐비트가 ∣0⟩ 상태로 붕괴되었음을 알 수 있습니다.

> 다음 큐비트 중 최대 얽힘이 있는 큐비트는? \
> 답: $\alpha\|000\rangle + \beta\|111\rangle$ \
만약 우리가 α∣000⟩+β∣111⟩ 상태의 큐비트를 측정한다면, 측정값이 0인지 1인지에 따라 해당 상태는 ∣000⟩ 또는 ∣111⟩으로 붕괴될 것입니다. 따라서 나중에 다른 큐비트를 측정한다면, 측정값이 어떻게 될지 미리 알 수 있습니다.

### 4. 벨 상태
다음은 2개의 큐비트를 갖는 일반적인 최대 얽힘 상태입니다. 이 4가지 상태를 벨 상태라고 합니다.

$\|\Phi^{+}\rangle = \frac{1}{\sqrt{2}}(\|00\rangle + \|11\rangle)$

$\|\Phi^{-}\rangle = \frac{1}{\sqrt{2}}(\|00\rangle - \|11\rangle)$

$\|\Psi^{+}\rangle = \frac{1}{\sqrt{2}}(\|01\rangle + \|10\rangle)$

$\|\Psi^{-}\rangle = \frac{1}{\sqrt{2}}(\|01\rangle - \|10\rangle)$


### 5. 부분 얽힘 큐비트
큐비트 중 하나를 측정했을 때, 측정 결과가 다른 큐비트의 진폭에 영향을 미치는 경우, 큐비트가 부분 얽힘 상태라고 합니다. 이 설명은 다소 혼란스러울 수 있으므로, 다음 예를 통해 이해하는 것이 좋습니다.

상태를 살펴보면, \
$\|\psi\rangle = \frac{\sqrt{3}}{\sqrt{5}}\|00\rangle + \frac{1}{\sqrt{5}}\|01\rangle + \frac{1}{2\sqrt{5}}\|10\rangle + \frac{\sqrt{3}}{2\sqrt{5}}\|11\rangle$

첫번째 큐비트를 0으로 측정한다면, 상태는 다음과 같이 붕괴한다. \
$\frac{\sqrt{3}}{2}\|00\rangle + \frac{1}{2}\|01\rangle = \|0\rangle \otimes (\frac{\sqrt{3}}{2}\|0\rangle + \frac{1}{2}\|1\rangle )$

보시다시피 두 번째 큐비트는 첫 번째 큐비트의 측정 결과에 따라 다른 진폭을 갖습니다. 한 큐비트의 진폭이 다른 큐비트의 측정 결과에 따라 변하고 여전히 중첩 상태에 있을 때, 우리는 이를 부분 얽힘 상태라고 합니다.

> 최대로 얽힌 큐비트와 부분적으로 얽힌 큐비트의 차이점은 최대로 얽힌 큐비트를 측정하면 다른 큐비트가 무엇으로 측정될지( 0 또는 1 ) 확실하게 결정할 수 있다는 것입니다
> 
> 반면, 부분적으로 얽힌 큐비트의 경우, 하나의 큐비트를 측정하면 다른 큐비트의 상태는 측정 결과에 따라 변하지만, 기저 상태(∣0⟩ 또는 ∣1⟩)로 붕괴되지 않고 중첩 상태를 유지합니다. 따라서 큐비트를 측정했을 때 측정 결과가 어떻게 될지 확실하게 판단할 수 없습니다.

> 두 개의 큐비트가 있고, 첫 번째 큐비트를 0으로 측정하면 두 번째 큐비트의 상태는 $\alpha_{0}\|0\rangle + \beta_{0}\|1\rangle$ 이 됩니다. 반면, 첫 번째 큐비트를 1로 측정하면 두 번째 큐비트의 상태는 $\alpha_{1}\|0\rangle + \beta_{1}\|1\rangle$ 이 됩니다. $\alpha_{0} \neq \alpha_{1} , \beta_{0} \neq \beta_{1}$ 그리고 $\alpha_{0}, \alpha_{1}, \beta_{0}, \beta_{1}$ 이 0이 아니라고 가정하면 어떤 유형의 엃힘인가요?
>
>답: 부분 얽힘

### 6. 연습문제
문제1. 상태 $\|\psi\rangle = \frac{1}{\sqrt{2}}(\|00\rangle + \|11\rangle)$ 는 얽혀있나요? 그 이유는?
> 답: 네, 최대로 얽혀 있습니다. 한 큐비트를 측정하면 다른 큐비트도 완전히 결정됩니다. 큐비트 중 하나를 0으로 측정하면 다른 큐비트도 0으로 측정될 것입니다. 왜냐하면 ∣0⟩으로 붕괴되기 때문입니다. 1도 마찬가지입니다.

문제2. 다음 상태를 단일 큐비트로 인수분해할 수 있나요? $\|\phi\rangle = \frac{3}{5}\|00\rangle + \frac{4}{5}\|01\rangle$
> 답: 네. 단일 큐비트 상태의 텐서곱으로 인수분해 가능. $\|0\rangle \otimes (\frac{3}{5}\|0\rangle + \frac{4}{5}\|1\rangle)$ 상태는 얽히지 않았다.

문제3. 상태 $\|\psi\rangle = \frac{1}{\sqrt{2}}(\|01\rangle + \|10\rangle)$ 는 최대 얽힘인가? 부분 얽힘인가?
> 답: 최대로 얽혀 있습니다. 한 큐비트를 측정하면 다른 큐비트도 확실하게 결정됩니다.

문제4. 상태 $\|\psi\rangle = \frac{1}{2}(\|00\rangle + \|01\rangle + \|10\rangle + \|11\rangle)$ 는 얽힘인가?
> 답: 얽히지 않았다. $\frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle) \otimes \frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle)$ 로 텐서곱으로 인수분해 된다.

문제5. 상태 $\|\psi\rangle = \frac{1}{\sqrt{2}}(\|00\rangle + \|11\rangle)$ 는 첫번째 큐비트가 $\|0\rangle$ 로 측정시 새로운 상태는?
> 답: 새로운 상태는 $\|00\rangle$ 이며, 두번째 큐비트는 $\|0\rangle$로 붕괴된다.

문제6. 상태 $\|\psi\rangle = \frac{1}{\sqrt{2}}(\|01\rangle + \|10\rangle)$ 는 두번째 큐비트가 $\|1\rangle$ 로 측정시 새로운 상태는?
> 답: 첫번째 큐비트는 $\|0\rangle$로 붕괴되고, 상태는 $\|01\rangle$ 이 된다.

문제7. 상태 $|\psi\rangle = \frac{1}{\sqrt{2}}(\|000\rangle + \|111\rangle)$ 는 얽힘인가?
> 답: 네, 최대로 얽혀 있습니다. 단일 큐비트를 측정하면 다른 두 큐비트의 상태가 결정됩니다

## 2.05 위상 킥백
### 1. 위상 킥백
위상 킥백은 제어 게이트의 작용을 통해 타겟 큐비트가 유니터리 게이트 U의 고유 벡터일 때 발생하는 현상이며, U의 고유값(λ)이 위상으로 변환되어 제어 큐비트에 전이되는 원리를 기초.

이 섹션은 위상 킥백(Phase Kickback)에 대한 짧은 강의로 마무리하겠습니다. 아래 양자 회로를 살펴보세요.

<img src="https://www.quantumsoar.com/_app/immutable/assets/phase_kickback_circuit.CbAv-UZG.png" width="400">

$\|v\rangle$ 는 고유값 $e^{i\theta}$ 를 갖는 $U$의 고유벡터라고 가정하면, 따라서: 

$U\|v\rangle = e^{i\theta}\|v\rangle$

회로를 살펴보면, $\|\psi_{1}\rangle$ 에서 \
$\|\psi_{1}\rangle = \|+\rangle\|v\rangle = \frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle) \otimes \|v\rangle$ \
$= \frac{1}{\sqrt{2}}(\|0\rangle\|v\rangle + \|1\rangle\|v\rangle)$

이제 첫 번째 큐비트를 제어로, 두 번째 큐비트를 목표로 하는 Controlled U Gate를 적용합니다
$\|\psi_{2}\rangle = CU\frac{1}{\sqrt{2}}(\|0\rangle\|v\rangle + \|1\rangle\|v\rangle) = \frac{1}{\sqrt{2}}(CU\|0\rangle\|v\rangle + CU\|1\rangle\|v\rangle) $ \
$= \frac{1}{\sqrt{2}}(\|0\rangle\|v\rangle + \|1\rangle U\|v\rangle) = \frac{1}{\sqrt{2}}(\|0\rangle\|v\rangle + \|1\rangle e^{i\theta}\|v\rangle)$

위에서 보셨듯이, 상태 ∣0⟩∣v⟩에서 제어는 0이므로 아무 일도 일어나지 않습니다. 반면 상태 ∣1⟩∣v⟩의 제어는 1이므로 U 게이트가 대상 ∣v⟩에 적용됩니다.

$\|\psi_{2}\rangle = \frac{1}{\sqrt{2}}(\|0\rangle\|v\rangle + \|1\rangle e^{i\theta}\|v\rangle)= \frac{1}{\sqrt{2}}(\|0\rangle\|v\rangle + e^{i\theta} \|1\rangle \|v\rangle)$ \
$= \frac{1}{\sqrt{2}}(\|0\rangle + e^{i\theta} \|1\rangle) \otimes \|v\rangle$

보시다시피 대상 큐비트 ∣v⟩는 변경되지 않았고, 상대 위상 $e^{i\theta}$가 제어 큐비트로 '되돌려 전달'되었습니다. 이러한 현상을 위상 킥백(Phase Kickback)이라고 합니다. 대상 큐비트가 가지고 있던 **위상 정보(상대 위상)**만 뽑혀 나와 '제어 큐비트'로 옮겨집니다

### 2. 위상 킥백 예제
위상 킥백의 또 다른 예를 살펴보겠습니다. \
$\|1\rangle$는 $Z$ 게이트의 고유 벡터입니다. 왜냐하면 $Z\|1\rangle = -\|1\rangle = e^{i\pi}\|1\rangle$ :

<img src="https://www.quantumsoar.com/_app/immutable/assets/phase_kickback_circuit_example.ZdZiy2wZ.png" width="400">

$\|\psi_{1}\rangle$ 에서:  \
$\|\psi_{1}\rangle = \frac{1}{\sqrt{2}}(\|0\rangle + \|1\rangle) \otimes \|1\rangle = \frac{1}{\sqrt{2}}(\|01\rangle + \|11\rangle)$

그런 다음에 Controlled Z 게이트를 적용합니다. \
$\|\psi_{2}\rangle = \frac{1}{\sqrt{2}}(CZ\|01\rangle + CZ\|11\rangle)= \frac{1}{\sqrt{2}}(\|01\rangle + Z\|11\rangle)= \frac{1}{\sqrt{2}}(\|01\rangle + (-1)\|11\rangle)$ \
$= \frac{1}{\sqrt{2}}(\|01\rangle - \|11\rangle)= \frac{1}{\sqrt{2}}(\|0\rangle - \|1\rangle) \otimes \|1\rangle$

보시다시피 대상 큐비트는 그대로 두고 고유값(−1)을 제어 큐비트에 상대 위상으로 추가했습니다.

> 대상 큐비트가 게이트의 고유 벡터가 아니면 무슨 일이 일어날까요?
>
> 답: 대상 큐비트가 게이트의 고유벡터가 아니므로 위상 킥백이 발생하지 않습니다. 따라서 대상 큐비트의 상태는 제어가 0인지 1인지에 따라 평소처럼 변환됩니다.

### 3. 연습문제
문제1. 다음 상태를 고려해 보세요.$\|\psi_{0}\rangle =\|+\rangle \otimes \|v\rangle$ 여기서 $\|v\rangle$ 는 고유값 $e^{i\theta}$을 갖는 U의 고유 벡터입니다. 첫 번째 큐비트를 제어로, 두 번째 큐비트를 목표로 하는 제어된 U 게이트를 적용한 후의 상태는 무엇일까요?
> 답: CU를 적용한 후의 상태는 $\|\psi_{1}\rangle = \frac{1}{\sqrt{2}}(\|0\rangle\|v\rangle +  e^{i\theta}\|1\rangle\|v\rangle) = \frac{1}{\sqrt{2}}(\|0\rangle + e^{i\theta} \|1\rangle )\|v\rangle$. \
대상 큐비트는 변경되지 않으며 위상은 제어 큐비트로 다시 돌아갑니다.

문제2. 첫번째 큐비트는 대상으로 두번째 큐비트를 제어로 하여, 상태 $\|\psi_{0}\rangle = \|+\rangle \otimes \|1\rangle$ 에 제어된 Z를 적용한 후의 결과 상태는 어떻게 되나요?
> 답: $\|\psi_{1}\rangle = \frac{1}{\sqrt{2}}(\|0\rangle - \|1\rangle) \otimes \|1\rangle$ 상태가 되며,첫 번째 큐비트의 $\|+\rangle$ 상태가 $\|-\rangle$로 바뀐 것을 의미, 대상의 Z 게이트의 고유값 −1은 제어 큐비트의 상대 위상으로 반동됩니다.


