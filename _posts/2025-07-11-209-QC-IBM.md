---
title: 6차시 9:Phase estimation and factoring (Phase estimation procedure)
layout: single
classes: wide
categories:
  - Fundamentals of quantum algorithms
toc: true # 이 포스트에서 목차를 활성화
toc_sticky: true # 목차를 고정할지 여부 (선택 사항)
---

# 위상 추정 절차

- 출처: [Phase estimation procedure](https://quantum.cloud.ibm.com/learning/en/courses/fundamentals-of-quantum-algorithms/phase-estimation-and-factoring/phase-estimation-procedure)

다음으로, 위상 추정 문제를 해결하기 위한 양자 알고리즘인 **위상 추정 절차**에 대해 논의할 것입니다.

먼저, 이 방법의 기본 직관을 설명하는 저정밀 워밍업부터 시작하겠습니다.
그 다음, 위상 추정 절차에서 사용되는 중요한 양자 연산인 **양자 푸리에 변환**과 그 양자 회로 구현에 대해 이야기할 것입니다.
양자 푸리에 변환을 이해하고 나면, 위상 추정 절차를 전반적으로 설명하고 그 성능을 분석할 것입니다.

## 1. 워밍업: 저정밀도로 위상 근사하기

위상 추정 문제에 대한 저정밀 해법을 제공하는 위상 추정 절차의 몇 가지 간단한 버전부터 시작하겠습니다.
이는 이 강의의 뒷부분에서 보게 될 일반적인 절차 뒤에 숨겨진 직관을 설명하는 데 도움이 됩니다.

### 1.1 위상 킥백 사용하기

우리가 찾고 있는 값 $\theta$에 대해 무언가를 배울 수 있게 해주는 위상 추정 문제에 대한 간단한 접근 방식은 **위상 킥백** 현상에 기반을 둡니다.
보시다시피, 이는 본질적으로 이 강의 뒷부분에서 논의될 일반적인 위상 추정 절차의 단일 큐비트 버전입니다.

위상 추정 문제의 입력의 일부로, 우리는 연산 $U$에 대한 유니터리 양자 회로를 가지고 있습니다.
우리는 이 회로의 설명을 사용하여 **제어된**-$U$ 연산을 위한 회로를 만들 수 있으며, 이는 이 그림이 시사하는 바와 같이 묘사될 수 있습니다 (왼쪽에는 양자 게이트로 간주되는 연산 $U$, 오른쪽에는 제어된-$U$ 연산).

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/uncontrolled-and-controlled-unitary.svg" alt="Example of a Boolean circuit" style="width: 50%;" />

우리는 $U$를 위한 회로에 제어 큐비트를 추가한 다음, $U$를 위한 회로의 모든 게이트를 해당 게이트의 제어된 버전으로 교체함으로써 제어된-$U$ 연산을 위한 양자 회로를 만들 수 있습니다 — 따라서 우리의 새로운 제어 큐비트 하나가 $U$를 위한 회로의 모든 단일 게이트를 효과적으로 제어합니다.

이는 우리 회로의 모든 게이트에 대한 제어된 버전이 있어야 함을 요구하지만, 우리의 게이트 세트에 포함되어 있지 않은 경우에도 이러한 제어된 연산을 위한 회로를 항상 만들 수 있습니다.

이제 다음 회로를 고려해 봅시다. 여기서 맨 위 큐비트를 제외한 모든 큐비트의 입력 상태$\vert\psi\rangle$는 $U$의 양자 상태 고유 벡터입니다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/estimate-phase-with-kickback.svg" alt="Example of a Boolean circuit" style="width: 50%;" />


이 회로의 측정 결과 확률은 고유 벡터$\vert\psi\rangle$에 해당하는 $U$의 고유값에 따라 달라집니다.
정확히 어떻게 되는지 알아보기 위해 회로를 자세히 분석해 봅시다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/estimate-phase-with-kickback-analysis.svg" alt="Example of a Boolean circuit" style="width: 50%;" />

회로의 초기 상태는 다음과 같고, 
\[
\vert\pi_0\rangle = \vert\psi\rangle \vert 0\rangle
\]

첫 번째 하닥마르 게이트는 이 상태를 다음으로 변환합니다.
\[
\vert\pi_1\rangle = \vert\psi\rangle \vert +\rangle
= \frac{1}{\sqrt{2}} \vert\psi\rangle \vert 0\rangle + \frac{1}{\sqrt{2}} \vert\psi\rangle \vert 1\rangle.
\]

다음으로, 제어된-$U$ 연산이 수행되어 다음 상태가 됩니다.
\[
\vert\pi_2\rangle
= \frac{1}{\sqrt{2}} \vert\psi\rangle \vert 0\rangle + \frac{1}{\sqrt{2}} \bigl(U \vert\psi\rangle\bigr) \vert 1\rangle.
\]

$\vert\psi\rangle$이 고유값 $\lambda = e^{2\pi\theta}$를 갖는 $U$의 고유벡터라고 가정하면,
\[
\vert\pi_2\rangle
= \frac{1}{\sqrt{2}} \vert\psi\rangle \vert 0\rangle + \frac{e^{2\pi i \theta}}{\sqrt{2}} \vert\psi\rangle \vert 1\rangle = \vert\psi\rangle \otimes \left( \frac{1}{\sqrt{2}} \vert 0\rangle + \frac{e^{2\pi i \theta}}{\sqrt{2}} \vert 1\rangle\right)
\]

상태를 다음과 같이 다르게 표현할 수 있습니다.

여기서 우리는 위상 킥백 현상을 관찰합니다.
이번에는 Deutsch 알고리즘 및 Deutsch-Jozsa 알고리즘에서와는 약간 다릅니다. 쿼리 게이트를 사용하지 않기 때문이지만, 아이디어는 비슷합니다.

마지막으로, 두 번째 하닥마르 게이트가 수행됩니다. 약간의 단순화 후, 이 상태에 대한 다음 표현을 얻습니다.
\[
\vert\pi_3\rangle
= \vert\psi\rangle \otimes \left( \frac{1+ e^{2\pi i \theta}}{2} \vert 0\rangle + \frac{1 - e^{2\pi i \theta}}{2} \vert 1\rangle\right)
\]

따라서 측정은 다음 확률로 $0$과 $1$의 결과를 산출합니다.
<br>
$$
\begin{aligned}
p_0 &= \left\vert \frac{1+ e^{2\pi i \theta}}{2} \right\vert^2 = \cos^2(\pi\theta)\\[1mm]
p_1 &= \left\vert \frac{1- e^{2\pi i \theta}}{2} \right\vert^2 = \sin^2(\pi\theta).
\end{aligned}
$$

여기 $\theta$의 함수로 가능한 두 가지 결과인 $0$과 $1$에 대한 확률을 나타낸 그래프가 있습니다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/kickback-probabilities.svg" alt="Example of a Boolean circuit" style="width: 50%;" />

당연히 두 확률의 합은 항상 $1$입니다.
$\theta = 0$일 때 측정 결과는 항상 $0$이고, $\theta = 1/2$일 때 측정 결과는 항상 $1$이라는 점에 주목하십시오.
따라서 측정 결과가 $\theta$가 정확히 무엇인지를 밝히지는 않지만, $\theta$에 대한 일부 정보를 제공하며 — 만약 $\theta = 0$ 또는 $\theta = 1/2$ 둘 중 하나라고 약속되었다면, 우리는 회로를 통해 오류 없이 어떤 것이 올바른지 알 수 있었습니다.

직관적으로 말해, 우리는 회로의 측정 결과를 $\theta$에 대한 "1비트 정확도"의 추측으로 생각할 수 있습니다.
다시 말해, $\theta$를 이진 표기법으로 쓰고 1비트로 반올림한다면, 다음과 같은 숫자를 얻을 것입니다.
<br>
$$
0.a = \begin{cases}
0 & a = 0\\
\frac{1}{2} & a = 1.
\end{cases}
$$

측정 결과는 비트 $a$에 대한 추측으로 볼 수 있습니다.
$\theta$가 $0$도 $1/2$도 아닐 때, 추측이 틀릴 확률이 0이 아니지만 — 오류를 범할 확률은 $0$ 또는 $1/2$에 가까워질수록 점점 작아집니다.

이 절차에서 두 하닥마르 게이트가 어떤 역할을 하는지 묻는 것은 자연스러운 일입니다.

*   **첫 번째 하닥마르 게이트**는 제어 큐비트를 $\vert 0\rangle$과 $\vert 1\rangle$의 균일 중첩으로 설정하여, 위상 킥백이 발생할 때 $\vert 0\rangle$ 상태가 아닌 $\vert 1\rangle$ 상태에 대해 발생하도록 합니다. 이는 측정 결과에 영향을 미치는 **상대적** 위상 차이를 생성합니다. 만약 우리가 이렇게 하지 않고 위상 킥백이 **전역** 위상을 생성했다면, 다른 측정 결과를 얻을 확률에 아무런 영향을 미치지 않았을 것입니다.

*   **두 번째 하닥마르 게이트**는 **간섭** 현상을 통해 숫자 $\theta$에 대해 무언가를 배우도록 해줍니다. 두 번째 하닥마르 게이트 이전에 맨 위 큐비트의 상태는 다음과 같으며,
\[
    \frac{1}{\sqrt{2}} \vert 0\rangle + \frac{e^{2\pi i \theta}}{\sqrt{2}} \vert 1\rangle,
\]

이 상태를 측정한다면, $0$과 $1$을 각각 $1/2$의 확률로 얻게 되어 $\theta$에 대해 아무것도 알려주지 않을 것입니다. 그러나 두 번째 하닥마르 게이트를 수행함으로써 숫자 $\theta$가 출력 확률에 영향을 미치게 합니다.

### 1.2 위상 두 배로 늘리기

위 회로는 위상 킥백 현상을 사용하여 $\theta$를 1비트 정확도로 근사합니다.
어떤 상황에서는 1비트 정확도만으로 충분할 수 있지만 — 인수분해에는 그보다 훨씬 더 높은 정확도가 필요합니다.
자연스러운 질문은, $\theta$에 대해 어떻게 더 많이 알 수 있는가? 입니다.

우리가 할 수 있는 한 가지 매우 간단한 방법은 우리 회로의 제어된-$U$ 연산을 이 회로처럼 이 연산의 **두 개의 복사본**으로 대체하는 것입니다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/double-phase-kickback.svg" alt="Example of a Boolean circuit" style="width: 50%;" />

제어된-$U$ 연산의 두 개의 복사본은 제어된-$U^2$ 연산과 동일합니다.
만약 $\vert\psi\rangle$가 고유값 $\lambda = e^{2\pi i \theta}$를 가지는 $U$의 고유 벡터라면, 이 상태는 또한 $U^2$의 고유 벡터이며, 이번에는 고유값 $\lambda^2 = e^{2\pi i (2\theta)}$를 가집니다.

따라서 이 버전의 회로를 실행하면, 숫자 $\theta$가 $2\theta$로 대체되는 것을 제외하고는 이전과 동일한 계산을 효과적으로 수행하는 것입니다.
여기 $\theta$가 $0$에서 $1$까지 변할 때 출력 확률을 보여주는 그래프가 있습니다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/double-kickback-probabilities.svg" alt="Example of a Boolean circuit" style="width: 50%;" />

이렇게 하면 $\theta$에 대한 추가 정보를 얻을 수 있습니다.
만약 $\theta$의 이진 표현이 다음과 같다면, 
\[
\theta = 0.a_1 a_2 a_3\cdots
\]
$\theta$를 두 배로 늘리면 이진 소수점이 오른쪽으로 한 자리 이동하는 효과가 있습니다.
\[
2\theta = a_1. a_2 a_3\cdots
\]

그리고 단위 원을 따라 움직일 때 $\theta = 1$을 $\theta = 0$과 동일시하므로, 비트 $a_1$이 우리의 확률에 영향을 미치지 않으며, $\theta$를 두 비트로 반올림하면 이진 소수점 다음의 **두 번째** 비트에 대한 추측을 효과적으로 얻는다는 것을 알 수 있습니다.
예를 들어, 만약 $\theta$가 $0$ 또는 $1/4$ 둘 중 하나라는 것을 미리 알고 있었다면, 우리는 측정 결과를 전적으로 신뢰하여 어떤 것인지 알 수 있었을 것입니다.

하지만 이 추정치가 $\theta$에 대해 가능한 가장 정확한 정보를 제공하기 위해 원래의 (두 배로 늘리지 않은) 위상 킥백 회로에서 배운 것과 어떻게 조화되어야 하는지는 즉시 명확하지 않습니다.
그러니 한 걸음 물러서서 어떻게 진행해야 할지 생각해 봅시다.

### 1.3 두 큐비트 위상 추정

위에 설명된 두 가지 옵션을 개별적으로 고려하기보다는, 다음과 같이 단일 회로로 결합해 봅시다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/two-bit-phase-estimation-initial.svg" alt="Example of a Boolean circuit" style="width: 50%;" />


제어된 연산 뒤의 하닥마르 게이트는 제거되었고 아직 측정이 없습니다.
$\theta$에 대해 가능한 한 많은 것을 배우기 위한 우리의 옵션을 고려하면서 회로에 더 많은 것을 추가할 것입니다.

만약 $\vert\psi\rangle$가 $U$의 고유 벡터일 때 이 회로를 실행하면, 아래쪽 큐비트들의 상태는 전체 회로 동안 $\vert\psi\rangle$로 유지될 것이고, 위상들은 맨 위 두 큐비트의 상태로 "킥백"될 것입니다.
다음 그림을 통해 회로를 신중하게 분석해 봅시다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/two-bit-phase-estimation-states.svg" alt="Example of a Boolean circuit" style="width: 50%;" />

상태는 다음과 같이 쓸 수 있습니다.
\[
\vert\pi_1\rangle = \vert \psi\rangle \otimes \frac{1}{2} \sum_{a_0 = 0}^1 \sum_{a_1 = 0}^1 \vert a_1 a_0 \rangle.
\]

첫 번째 제어된-$U$ 연산이 수행될 때, 고유값 $\lambda = e^{2\pi i\theta}$는 $a_0$ (맨 위 큐비트)가 $1$일 때 위상으로 킥백되지만, $0$일 때는 킥백되지 않습니다.
따라서 결과 상태를 다음과 같이 표현할 수 있습니다.
\[
\vert\pi_2\rangle
= \vert\psi\rangle \otimes \frac{1}{2} \sum_{a_0=0}^1 \sum_{a_1=0}^1 e^{2 \pi i a_0 \theta} \vert a_1 a_0 \rangle.
\]

두 번째 및 세 번째 제어된-$U$ 게이트는 $a_0$ 대신 $a_1$에 대해 유사한 작업을 수행하며, $\theta$는 $2\theta$로 대체됩니다.
결과 상태를 다음과 같이 표현할 수 있습니다.
\[
\vert\pi_3\rangle
= \vert\psi\rangle\otimes\frac{1}{2}\sum_{a_0 = 0}^1 \sum_{a_1 = 0}^1
e^{2\pi i (2 a_1 + a_0)\theta} \vert a_1 a_0 \rangle.
\]

이진 문자열 $a_1 a_0$을 이진 표기법으로 $x = 2 a_1 + a_0$인 정수 $x \in \{0,1,2,3\}$로 생각한다면, 이 상태를 다음과 같이 다르게 표현할 수 있습니다.
\[
\vert\pi_3\rangle = \vert \psi\rangle \otimes \frac{1}{2} \sum_{x = 0}^3 e^{2\pi i x \theta} \vert x \rangle
\]

우리의 목표는 이 상태에서 $\theta$에 대한 가능한 한 많은 정보를 추출하는 것입니다.

이 시점에서 우리는 $\theta = y/4$ (여기서 $y\in\{0,1,2,3\}$는 정수)라고 약속된 특별한 경우를 고려할 것입니다.
다시 말해, 우리는 $\theta\in \{0, 1/4, 1/2, 3/4\}$를 가지므로, 이 숫자를 두 비트의 이진 표기법으로 $0.00, 0.01, 0.10,$ 또는 $0.11$과 같이 정확하게 표현할 수 있습니다.
일반적으로 $\theta$는 이 네 가지 값 중 하나가 아닐 수 있지만, 이 특별한 경우를 생각하면 일반적인 $\theta$에 대한 정보를 가장 효과적으로 추출하는 방법을 알아내는 데 도움이 될 것입니다.

먼저 각 가능한 $y \in \{0, 1, 2, 3\}$ 값에 대한 두 큐비트 상태 벡터를 정의할 것입니다.
\[
\vert \phi_y\rangle = \frac{1}{2} \sum_{x = 0}^3 e^{2\pi i x (\frac{y}{4})} \vert x \rangle
= \frac{1}{2} \sum_{x = 0}^3 e^{2\pi i \frac{x y}{4}} \vert x \rangle
\]

지수를 단순화한 후, 이 벡터들을 다음과 같이 쓸 수 있습니다.
<br>
$$
\begin{aligned}
\vert\phi_0\rangle & = \frac{1}{2} \vert 0 \rangle + \frac{1}{2} \vert 1 \rangle + \frac{1}{2} \vert 2 \rangle + \frac{1}{2} \vert 3 \rangle \\[3mm]
\vert\phi_1\rangle & = \frac{1}{2} \vert 0 \rangle + \frac{i}{2} \vert 1 \rangle - \frac{1}{2} \vert 2 \rangle - \frac{i}{2} \vert 3 \rangle \\[3mm]
\vert\phi_2\rangle & = \frac{1}{2} \vert 0 \rangle - \frac{1}{2} \vert 1 \rangle + \frac{1}{2} \vert 2 \rangle - \frac{1}{2} \vert 3 \rangle \\[3mm]
\vert\phi_3\rangle & = \frac{1}{2} \vert 0 \rangle - \frac{i}{2} \vert 1 \rangle - \frac{1}{2} \vert 2 \rangle + \frac{i}{2} \vert 3 \rangle
\end{aligned}
$$

이 벡터들은 직교합니다: 그들 중 어떤 쌍을 선택하여 내적을 계산하더라도 $0$을 얻습니다.
각각은 또한 단위 벡터이므로, $\{\vert\phi_0\rangle, \vert\phi_1\rangle, \vert\phi_2\rangle, \vert\phi_3\rangle\}$는 정규 직교 기저입니다.
따라서 우리는 그들을 완벽하게 구별할 수 있는 측정이 있다는 것을 즉시 압니다 — 즉, 우리에게 그들 중 하나가 주어졌지만 어떤 것인지 모를 때, 오류 없이 어떤 것인지 알아낼 수 있습니다.

양자 회로로 그러한 구별을 수행하기 위해, 먼저 표준 기저 상태를 위에 나열된 네 가지 상태로 변환하는 유니터리 연산 $V$를 정의할 수 있습니다.

<br>
$$
\begin{aligned}
V \vert 00 \rangle & = \vert\phi_0\rangle \\
V \vert 01 \rangle & = \vert\phi_1\rangle \\
V \vert 10 \rangle & = \vert\phi_2\rangle \\
V \vert 11 \rangle & = \vert\phi_3\rangle
\end{aligned}
$$

$V$를 $4\times 4$ 행렬로 작성하는 것은 단지 $V$의 열을 상태 $\vert\phi_0\rangle,\ldots,\vert\phi_3\rangle$로 취하는 문제입니다.
<br>
$$
V =
\frac{1}{2}
\begin{pmatrix}
1 & 1 & 1 & 1\\[1mm]
1 & i & -1 & -i\\[1mm]
1 & -1 & 1 & -1\\[1mm]
1 & -i & -1 & i
\end{pmatrix}
$$

이것은 특별한 행렬이며, 일부 독자는 이전에 접했을 가능성이 있습니다. 이는 4차원 **이산 푸리에 변환**과 관련된 행렬입니다.
이 사실을 고려하여, $V$ 대신 **$\mathrm{QFT}_4$**라는 이름으로 부르겠습니다.
**$\mathrm{QFT}$**는 **양자 푸리에 변환**의 약자입니다 — 이는 본질적으로 이산 푸리에 변환을 유니터리 연산으로 본 것과 같습니다.
양자 푸리에 변환에 대해 더 자세하고 일반적으로 곧 논의할 것입니다.
<br>
$$
\mathrm{QFT}_4 =
\frac{1}{2}
\begin{pmatrix}
1 & 1 & 1 & 1\\[1mm]
1 & i & -1 & -i\\[1mm]
1 & -1 & 1 & -1\\[1mm]
1 & -i & -1 & i
\end{pmatrix}
$$

우리는 이 연산의 역을 수행하여 반대 방향으로, 즉 상태 $\vert\phi_0\rangle,\ldots,\vert\phi_3\rangle$를 표준 기저 상태 $\vert 0\rangle,\ldots,\vert 3\rangle$로 변환할 수 있습니다.
이렇게 하면, 우리는 $\theta$를 $\theta = y/4$로 설명하는 $y\in\{0,1,2,3\}$ 값을 측정하여 알 수 있습니다.
여기 이를 수행하는 양자 회로 다이어그램이 있습니다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/two-bit-phase-estimation.svg" alt="Example of a Boolean circuit" style="width: 50%;" />

요약하자면, $y\in\{0,1,2,3\}$에 대해 $\theta = y/4$일 때 이 회로를 실행하면, 측정 직전의 상태는 $\vert \psi\rangle \vert y\rangle$ (y는 두 비트 이진 문자열로 인코딩됨)가 되므로, 측정은 $y$ 값을 오류 없이 밝혀낼 것입니다.

이 회로는 $\theta \in \{0,1/4,1/2,3/4\}$인 특별한 경우에 의해 동기 부여되었지만 — 우리가 원하는 $U$와 $\vert \psi\rangle$의 어떤 선택에 대해서도, 따라서 어떤 $\theta$ 값에 대해서도 실행할 수 있습니다.
여기 임의의 $\theta$ 선택에 대해 회로가 생성하는 출력 확률의 그래프가 있습니다.

<img src="{{site.url}}{{site.baseurl}}/assets/images/QC2/two-bit-probabilities.svg" alt="Example of a Boolean circuit" style="width: 50%;" />


이는 이 강의의 앞부분에서 설명된 단일 큐비트 변형에 비해 명확한 개선입니다.
완벽하지는 않습니다 — 잘못된 답을 줄 수도 있습니다 — 하지만 답은 $y/4$가 $\theta$에 가까운 $y$ 값 쪽으로 크게 치우쳐 있습니다.
특히, 가장 가능성 있는 결과는 항상 $\theta$에 가장 가까운 $y/4$ 값에 해당하며 (이전과 같이 $\theta = 0$과 $\theta = 1$을 동일시함), 그래프에서 보면 이 $x$에 대한 가장 가까운 값은 항상 40%를 약간 넘는 확률로 나타나는 것 같습니다.
예를 들어 $\theta = 0.375$와 같이 $\theta$가 두 값의 정확히 중간에 있을 때는, 동일하게 가까운 두 $y$ 값이 동일한 확률을 가집니다.

### 1.4 다중 큐비트로 일반화 준비

하나 대신 두 개의 제어 큐비트를 사용하고 4차원 양자 푸리에 변환의 역을 함께 사용하여 방금 얻은 개선을 고려할 때, 더 많은 제어 큐비트를 추가하여 이를 더 일반화하는 것을 고려하는 것은 자연스러운 일입니다.
이렇게 하면 일반적인 **위상 추정 절차**를 얻습니다.
곧 이것이 어떻게 작동하는지 보겠지만, 이를 정확하게 설명하기 위해서는 양자 푸리에 변환을 더 일반적으로 논의해야 합니다. 다른 차원에서 어떻게 정의되는지, 그리고 양자 회로로 어떻게 구현할 수 있는지 (또는 그 역을) 알아보기 위해서입니다.

## 2. 양자 푸리에 변환

양자 푸리에 변환은 어떤 양의 정수 차원 $N$에 대해서도 정의될 수 있는 유니터리 연산입니다.
이 섹션에서는 이 연산이 어떻게 정의되는지, 그리고 $N = 2^m$일 때 $O(m^2)$의 비용으로 $m$ 큐비트 상에서 양자 회로로 어떻게 구현될 수 있는지 알아볼 것입니다.

양자 푸리에 변환을 설명하는 행렬은 **이산 푸리에 변환**이라고 알려진 $N$차원 벡터에 대한 유사한 연산에서 파생됩니다.
이 연산은 여러 가지 방식으로 생각할 수 있습니다.
예를 들어, 우리는 이산 푸리에 변환을 순수하게 추상적이고 수학적인 용어로 선형 매핑으로 생각할 수 있습니다.
또는 우리는 $N$차원 복소수 벡터가 주어지고 (항목의 실수부와 허수부를 인코딩하기 위해 이진 표기법을 사용한다고 가정합시다) 이산 푸리에 변환을 적용하여 얻은 $N$차원 벡터를 계산하는 것이 목표인 계산적 용어로 생각할 수 있습니다.
우리의 초점은 세 번째 방식, 즉 이 변환을 양자 시스템에서 수행할 수 있는 유니터리 연산으로 보는 것에 맞춰질 것입니다.

주어진 입력 벡터에 대해 이산 푸리에 변환을 계산하는 효율적인 알고리즘이 있는데, 이를 **고속 푸리에 변환**이라고 합니다.
이는 신호 처리 및 기타 여러 분야에 응용되며, 많은 사람들에게 지금까지 발견된 가장 중요한 알고리즘 중 하나로 여겨집니다.

결과적으로, 우리가 연구할 $N$이 2의 거듭제곱일 때 양자 푸리에 변환의 구현은 고속 푸리에 변환을 가능하게 하는 바로 그 동일한 기본 구조에 기반을 둡니다.

### 2.1 양자 푸리에 변환의 정의

양자 푸리에 변환을 정의하기 위해, 먼저 각 양의 정수 $N$에 대해 복소수 $\omega_N$를 다음과 같이 정의할 것입니다.
\[
\omega_N = e^{\frac{2\pi i}{N}} = \cos\left(\frac{2\pi}{N}\right) + i \sin\left(\frac{2\pi}{N}\right).
\]

이는 $1$에서 시작하여 반시계 방향으로 $2\pi/N$ 라디안 각도, 또는 원주 둘레의 $1/N$만큼 이동할 때 복소수 단위 원에서 얻는 숫자입니다. 몇 가지 예는 다음과 같습니다.
<br>
$$
\begin{gathered}
\omega_1 = 1\\[1mm]
\omega_2 = -1\\[1mm]
\omega_3 = -\frac{1}{2} + \frac{\sqrt{3}}{2} i\\[2mm]
\omega_4 = i\\[1mm]
\omega_8 = \frac{1+i}{\sqrt{2}}\\[3mm]
\omega_{16} = \frac{\sqrt{2 + \sqrt{2}}}{2} + \frac{\sqrt{2 - \sqrt{2}}}{2} i\\[2mm]
\omega_{100} \approx 0.998 + 0.063 i
\end{gathered}
$$

이제 우리는 표준 기저 상태 $\vert 0\rangle,\ldots,\vert N-1\rangle$와 행과 열이 연관된 $N\times N$ 행렬로 설명되는 $N$차원 양자 푸리에 변환을 정의할 수 있습니다.
우리는 위상 추정을 위해 $N = 2^m$이 2의 거듭제곱인 경우에만 이 연산이 필요할 것이지만, 이 연산은 어떤 양의 정수 $N$에 대해서도 정의될 수 있습니다.
\[
\mathrm{QFT}_N = \frac{1}{\sqrt{N}} \sum_{x = 0}^{N-1} \sum_{y = 0}^{N-1} \omega_N^{xy} \vert x \rangle\langle y\vert
\]

이미 언급했듯이, 이것은 $N$차원 **이산 푸리에 변환**과 관련된 행렬입니다.
종종 이 행렬의 정의에는 선행 계수 $1/\sqrt{N}$가 포함되지 않지만, 유니터리 행렬을 얻기 위해서는 이를 포함해야 합니다.

여기 몇 가지 작은 $N$ 값에 대해 행렬로 작성된 양자 푸리에 변환이 있습니다.

<br>
$$
\mathrm{QFT}_1 = \begin{pmatrix} 1 \end{pmatrix}
$$
<br>
<br>
$$
\mathrm{QFT}_2 =
\frac{1}{\sqrt{2}} \begin{pmatrix} 1 & 1\\[1mm] 1 & -1 \end{pmatrix}
$$
<br>
<br>
$$
\mathrm{QFT}_3 =
\frac{1}{\sqrt{3}}
\begin{pmatrix}
   1 & 1 & 1\\[2mm]
   1 & \frac{-1 + i\sqrt{3}}{2} & \frac{-1 - i\sqrt{3}}{2}\\[2mm]
   1 & \frac{-1 - i\sqrt{3}}{2} & \frac{-1 + i\sqrt{3}}{2}
\end{pmatrix}
$$
<br>
<br>
$$
\mathrm{QFT}_4 =
\frac{1}{2}
\begin{pmatrix}
1 & 1 & 1 & 1\\[1mm]
1 & i & -1 & -i\\[1mm]
1 & -1 & 1 & -1\\[1mm]
1 & -i & -1 & i
\end{pmatrix}
$$
<br>
<br>
$$
\mathrm{QFT}_8 =
\frac{1}{2\sqrt{2}}
\begin{pmatrix}
  1 & 1 & 1 & 1 & 1 & 1 & 1 & 1\\[2mm]
  1 & \frac{1+i}{\sqrt{2}} & i & \frac{-1+i}{\sqrt{2}} & -1 & \frac{-1-i}{\sqrt{2}} & -i & \frac{1-i}{\sqrt{2}}\\[2mm]
  1 & i & -1 & -i & 1 & i & -1 & -i\\[2mm]
  1 & \frac{-1+i}{\sqrt{2}} & -i & \frac{1+i}{\sqrt{2}} & -1 & \frac{1-i}{\sqrt{2}} & i & \frac{-1-i}{\sqrt{2}}\\[2mm]
  1 & -1 & 1 & -1 & 1 & -1 & 1 & -1\\[2mm]
  1 & \frac{-1-i}{\sqrt{2}} & i & \frac{1-i}{\sqrt{2}} & -1 & \frac{1+i}{\sqrt{2}} & -i & \frac{-1+i}{\sqrt{2}}\\[2mm]
  1 & -i & -1 & i & 1 & -i & -1 & i\\[2mm]
  1 & \frac{1-i}{\sqrt{2}} & -i & \frac{-1-i}{\sqrt{2}} & -1 & \frac{-1+i}{\sqrt{2}} & i & \frac{1+i}{\sqrt{2}}\\[2mm]
\end{pmatrix}
$$

특히, $\mathrm{QFT}_2$는 하닥마르 연산의 다른 이름이라는 점에 주목하십시오.

### 2.2 유니터리성

😀😀여기서부터 정리필요😀😀😀😀😀😀😀😀😀😀😀😀
어떤 $N$의 선택에 대해서도 $\mathrm{QFT}_N$가 유니터리인지 확인해 봅시다.
이를 수행하는 한 가지 방법은 그 열들이 정규 직교 기저를 형성함을 보이는 것입니다.
$y = 0$부터 $y = N-1$까지의 열 번호 $y$에 해당하는 벡터를 다음과 같이 정의할 수 있습니다.
이 벡터들 중 임의의 두 벡터 사이의 내적을 취하면 다음 표현을 얻습니다.
우리는 등비수열의 처음 $N$개 항의 합에 대한 다음 공식을 사용하여 이와 같은 합을 계산할 수 있습니다.
특히, $\alpha = \omega_N^{y-z}$일 때 이 공식을 사용할 수 있습니다.
$y = z$일 때, $\alpha = 1$이므로 공식을 사용하고 $N$으로 나누면 다음을 얻습니다.
$y\neq z$일 때, $\alpha \neq 1$이므로 공식은 다음을 보여줍니다.
이는 $\omega_N^N = e^{2\pi i} = 1$이므로 $\omega_N^{N(y-z)} = 1^{y-z} = 1$이 되어 분자가 0이 되고, $\omega_N^{y-z} \neq 1$이므로 분모는 0이 아니기 때문에 발생합니다.
직관적으로 말해, 우리가 하는 일은 단위 원 주위에 분포된 여러 점을 합하는 것이며, 이 점들은 합해질 때 서로 상쇄되어 $0$이 됩니다.
따라서 우리는 $\{\vert\phi_0\rangle,\ldots,\vert\phi_{N-1}\rangle\}$가 정규 직교 집합임을 확립했습니다. 이는 $\mathrm{QFT}_N$가 유니터리임을 보여줍니다.

### 2.3 제어 위상 게이트
양자 회로로 양자 푸리에 변환을 구현하기 위해, 우리는 **제어 위상** 게이트를 사용해야 합니다.
**위상 연산**은 다음과 같은 형태의 단일 큐비트 유니터리 연산입니다. 임의의 실수 $\alpha$에 대해.
이 게이트의 제어된 버전은 다음 행렬을 가집니다.
이 제어된 게이트의 경우, 어떤 큐비트가 제어 큐비트이고 어떤 큐비트가 목표 큐비트인지는 실제로 중요하지 않습니다. 두 가지 가능성이 동일하기 때문입니다.
양자 회로 다이어그램에서 이 게이트를 나타내기 위해 다음 기호 중 어느 것이든 사용할 수 있습니다.

[이미지 설명: 제어 위상 게이트에 대한 양자 회로 다이어그램 표현]
세 번째 형태의 경우, $\alpha$ 레이블은 편리할 때 제어 라인 옆이나 아래쪽 제어 아래에 놓이기도 합니다.
$N = 2^m$이고 $m\geq 2$일 때 양자 푸리에 변환을 수행하기 위해, 우리는 표준 기저 상태에 대한 작용이 다음과 같이 설명될 수 있는 $m$ 큐비트에 대한 연산을 수행해야 합니다.
여기서 $a$는 비트이고 $y \in \{0,\ldots,2^{m-1} - 1\}$는 $m-1$ 비트의 문자열로 이진 표기법으로 인코딩된 숫자입니다.
이는 $m=5$인 다음 예시를 일반화하여 제어 위상 게이트를 사용하여 수행할 수 있습니다.

[이미지 설명: 위상 주입을 위한 양자 회로 다이어그램]
일반적으로, 임의의 $m\geq 2$ 선택에 대해, 비트 $a$에 해당하는 맨 위 큐비트는 제어로 볼 수 있으며, 위상 게이트 $P_{\alpha}$는 $y$의 최하위 비트에 해당하는 큐비트에는 $\alpha = \pi/2^{m-1}$부터 $y$의 최상위 비트에 해당하는 큐비트에는 $\alpha = \frac{\pi}{2}$까지 범위입니다.
이 제어 위상 게이트들은 모두 서로 교환 가능하며 어떤 순서로든 수행될 수 있습니다.

### 2.4 QFT의 회로 구현
이제 차원 $N = 2^m$이 2의 거듭제곱일 때 회로로 양자 푸리에 변환을 어떻게 구현할 수 있는지 알아볼 것입니다.
사실, 양자 푸리에 변환을 구현하는 여러 방법이 있지만, 이것이 알려진 가장 간단한 방법이라고 할 수 있습니다.
양자 회로로 양자 푸리에 변환을 구현하는 방법을 알게 되면, 그 역을 구현하는 것은 간단합니다: 각 게이트를 역 (또는 동등하게 켤레 전치)으로 교체하고 게이트를 역순으로 적용할 수 있습니다.
유니터리 게이트만으로 구성된 모든 양자 회로는 이런 방식으로 역변환될 수 있습니다.
구현은 본질적으로 재귀적이므로, 그렇게 설명하는 것이 가장 자연스럽습니다.
기저 사례는 $m=1$이며, 이 경우 양자 푸리에 변환은 하닥마르 연산입니다.
$m \geq 2$일 때 $m$ 큐비트에서 양자 푸리에 변환을 수행하기 위해, 우리는 다음 단계를 수행할 수 있으며, 그 동작은 표준 기저 상태의 형식에 대해 설명할 것입니다. 여기서 $x\in\{0,\ldots,2^{m-1} - 1\}$는 이진 표기법을 사용하여 $m-1$ 비트로 인코딩된 정수이고 $a$는 단일 비트입니다.

1.  먼저 아래/가장 왼쪽 $m-1$ 큐비트에 $2^{m-1}$차원 양자 푸리에 변환을 적용하여 다음 상태를 얻습니다. 이는 단일 큐비트에 대한 하닥마르 연산을 기저 사례로 사용하여, 큐비트가 하나 적은 경우에 대해 설명되는 방법을 재귀적으로 적용함으로써 수행됩니다.
2.  맨 위/가장 오른쪽 큐비트를 제어로 사용하여 나머지 $m-1$ 큐비트의 각 표준 기저 상태에 대해 위상을 주입하여 (위에서 설명한 대로) 다음 상태를 얻습니다.
3.  맨 위/가장 오른쪽 큐비트에 하닥마르 게이트를 수행하여 다음 상태를 얻습니다.
4.  큐비트의 순서를 바꾸어 최하위 비트가 최상위 비트가 되고, 다른 모든 비트가 위/오른쪽으로 이동하도록 합니다.

예를 들어, $N = 32 = 2^5$에 대해 우리가 얻는 회로는 다음과 같습니다.
이 다이어그램에서는 명확성을 위해 큐비트에 표준 기저 벡터 (입력용) 및 (출력용)에 해당하는 이름이 부여됩니다.

[이미지 설명: 32차원 양자 푸리에 변환을 위한 양자 회로 다이어그램]

### 2.5 분석
방금 설명된 회로가 $2^m$차원 양자 푸리에 변환을 구현하는지 확인하는 데 필요한 핵심 공식은 다음과 같습니다.
이 공식은 정수 $a, b, x, y$의 어떤 선택에 대해서도 작동하지만, 우리는 $a,b\in\{0,1\}$ 및 $x,y\in\{0,\ldots,2^{m-1}-1\}$인 경우에만 필요합니다.
이는 오른쪽 항의 지수에서 곱을 전개하여 확인할 수 있습니다. 여기서 두 번째 등호는 다음 관찰을 사용합니다.
$2^m$차원 양자 푸리에 변환은 모든 $u\in\{0,\ldots,2^m - 1\}$에 대해 다음과 같이 정의됩니다.
만약 우리가 $u$와 $v$를 다음과 같이 쓴다면, $a,b\in\{0,1\}$ 및 $x,y\in\{0,\ldots,2^{m-1} - 1\}$에 대해, 우리는 다음을 얻습니다.
마지막으로, 표준 기저 상태와 를 범위의 정수에 대한 이진 인코딩으로 생각함으로써, 우리는 위 회로가 필요한 연산을 구현한다는 것을 알 수 있습니다.
양자 푸리에 변환을 수행하는 이 방법이 놀랍게 보인다면, 그것은 사실이기 때문입니다. 이는 본질적으로 양자 회로 형태의 고속 푸리에 변환입니다.
마지막으로, 방금 설명된 회로에서 사용되는 게이트 수를 세어 봅시다.
제어 위상 게이트는 이전 강의에서 논의한 표준 게이트 세트에 포함되어 있지 않지만, 우선 이것을 무시하고 각각을 단일 게이트로 세어 봅시다.
$m$의 각 가능한 선택에 대해 필요한 게이트 수를 $s_m$이라고 합시다.
$m=1$일 때, 양자 푸리에 변환은 단지 하닥마르 연산이므로.
$m\geq 2$일 때, 위 회로에서 $m-1$ 큐비트에 대한 양자 푸리에 변환을 위해 $s_{m-1}$개의 게이트가 필요하며, $m-1$개의 제어 위상 게이트, 하닥마르 게이트 하나, 그리고 $m-1$개의 스왑 게이트가 추가로 필요합니다.
합산하여 닫힌 형태의 표현을 얻을 수 있습니다.
실제로 이 방법이 설명하는 만큼 많은 스왑 게이트가 필요하지 않습니다.
게이트를 약간 재배열하면 모든 스왑 게이트를 오른쪽으로 밀어내고 필요한 스왑 게이트 수를 $\lfloor m/2\rfloor$로 줄일 수 있습니다.
점근적으로 말하면 이것은 큰 개선이 아닙니다: $\mathrm{QFT}_{2^m}$를 수행하기 위한 $O(m^2)$ 크기의 회로를 여전히 얻습니다.
표준 게이트 세트의 게이트만 사용하여 양자 푸리에 변환을 구현하려면, 각 제어 위상 게이트를 우리 세트의 게이트로 만들거나 근사화해야 합니다.
필요한 수는 우리가 요구하는 정확도에 따라 다르지만, $m$의 함수로 총 비용은 여전히 이차적입니다.
실제로 $\alpha$가 매우 작을 때 $P_{\alpha}$가 항등 연산에 매우 가깝다는 사실을 이용하여 2차 미만의 게이트 수로 양자 푸리에 변환을 상당히 가깝게 근사화하는 것이 가능합니다 — 이는 정확도 손실을 크게 입지 않고 대부분의 제어 위상 게이트를 단순히 생략할 수 있다는 의미입니다.

## 3. 일반적인 절차 및 분석
이제 위상 추정 절차를 일반적으로 검토할 것입니다.
아이디어는 위에서 고려한 두 큐비트 버전의 위상 추정을 다음 다이어그램이 제안하는 자연스러운 방식으로 확장하는 것입니다.

[이미지 설명: 위상 추정 절차]
맨 위에 추가되는 각 새로운 제어 큐비트에 대해, 우리는 유니터리 연산 $U$가 수행되는 횟수를 **두 배로** 늘립니다.
이는 다이어그램에서 각 제어 유니터리 연산에 대한 $U$의 거듭제곱으로 표시됩니다.
어떤 $k$의 선택에 대해 제어된-$U^k$ 연산을 구현하는 가장 간단한 방법은 단순히 제어된-$U$ 연산을 $k$번 반복하는 것입니다.
실제로 이 방법론이 사용된다면, 제어 큐비트의 추가가 회로의 크기에 상당한 기여를 한다는 점을 인식해야 합니다: 다이어그램이 보여주듯이 $m$개의 제어 큐비트가 있다면, 총 $2^m - 1$개의 제어된-$U$ 연산 복사본이 필요합니다.
이는 $m$이 증가함에 따라 상당한 계산 비용이 발생한다는 것을 의미하지만 — 보시다시피, 이는 또한 $\theta$의 훨씬 더 정확한 근사치로 이어집니다.
그러나 *일부* $U$의 선택에 대해서는 $U$를 위한 회로를 $k$번 단순히 반복하는 것보다 더 효율적인 방식으로 큰 $k$ 값에 대해 연산 $U^k$를 구현하는 회로를 만들 수 있다는 점을 유의하는 것이 중요합니다.
우리는 이 강의 뒷부분에서 정수 인수분해의 맥락에서 이것의 특정 예를 볼 것입니다. 거기서는 이전 강의에서 논의된 **모듈러 지수화**를 위한 효율적인 알고리즘이 도움이 됩니다.
이제 방금 설명된 회로를 분석해 봅시다.
역 양자 푸리에 변환 직전의 상태는 다음과 같습니다.

### 3.1 특별한 경우
$m=2$ 경우에서 우리가 했던 것과 유사하게, 우리는 먼저 $y\in\{0,\ldots,2^m-1\}$에 대해 $\theta = y/2^m$인 특별한 경우를 고려할 것입니다.
이 경우 역 양자 푸리에 변환 전의 상태는 다음과 같이 다르게 작성될 수 있습니다.
따라서 역 양자 푸리에 변환이 적용되면 상태는 다음과 같이 되고, 측정은 $y$ (이진수로 인코딩됨)를 밝혀냅니다.

### 3.2 확률 경계 설정
$y$ 정수에 대해 $y/2^m$ 형태를 취하지 않는 다른 $\theta$ 값의 경우, 측정 결과는 확실하지 않겠지만, 우리는 다른 결과에 대한 확률에 대한 경계를 증명할 수 있습니다.
이어서, $0\leq \theta < 1$을 만족하는 $\theta$의 임의의 선택을 고려해 봅시다.
역 양자 푸리에 변환이 수행된 후, 회로의 상태는 다음과 같습니다.
따라서 맨 위 $m$ 큐비트에 대한 측정이 수행될 때, 우리는 각 결과 $y$를 다음 확률로 봅니다.
이러한 확률을 더 잘 파악하기 위해, 우리는 이전에 보았던 등비수열의 초기 부분 합에 대한 동일한 공식을 사용할 것입니다.
$p_y$ 공식에 나타나는 합을 $\alpha = e^{2\pi i (\theta - y/2^m)}$로 취하여 단순화할 수 있습니다.
우리가 얻는 것은 다음과 같습니다.
따라서 $\theta = y/2^m$인 경우, 우리는 $p_y = 1$임을 알 수 있습니다 (이 특별한 경우를 고려하여 이미 알고 있었듯이). 그리고 $\theta \neq y/2^m$인 경우, 우리는 다음을 알 수 있습니다.
단위 원에서 호 길이와 현 길이가 어떻게 관련되어 있는지 생각함으로써 이러한 확률에 대해 더 많이 알 수 있습니다.
여기 어떤 실수 $\delta\in \bigl[ -\frac{1}{2},\frac{1}{2}\bigr]$에 대해 필요한 관계를 보여주는 그림이 있습니다.

[이미지 설명: 호 길이와 현 길이의 관계에 대한 설명]
첫째, (파란색으로 그려진) 현 길이는 (보라색으로 그려진) 호 길이보다 클 수 없습니다.
이 길이를 반대 방향으로 관련시키면, 호 길이와 현 길이의 비율이 $\delta = \pm 1/2$일 때 가장 크다는 것을 알 수 있으며, 이 경우 비율은 원주 둘레의 절반을 지름으로 나눈 값, 즉 $\pi/2$입니다.
따라서 우리는 다음을 얻고, 그리고 따라서 다음을 얻습니다.
이러한 관계에 기반한 분석은 다음 두 가지 사실을 밝혀냅니다.

1.  $\theta$가 실수이고 $y\in \{0,\ldots,2^m-1\}$가 다음을 만족한다고 가정해 봅시다.
    이는 $y/2^m$이 $\theta$에 대한 최적의 $m$비트 근사치이거나, $y/2^m$과 $(y-1)/2^m$ 또는 $(y+1)/2^m$의 정확히 중간에 있다는 것을 의미하므로, $\theta$에 대한 두 가지 최적 근사치 중 하나입니다.
    우리는 이 경우 $p_y$가 상당히 커야 함을 증명할 것입니다.
    우리가 고려하는 가정에 따르면, 이므로, 위에서 호 길이와 현 길이를 관련시킨 두 번째 관찰을 사용하여 다음을 결론 내릴 수 있습니다.
    또한 호 길이와 현 길이에 대한 첫 번째 관찰을 사용하여 다음을 결론 내릴 수 있습니다.
    이 두 부등식을 $p_y$에 적용하면 다음이 밝혀집니다.
    이는 이전에 논의된 $m=2$ 버전의 위상 추정에서 최적의 결과가 40% 이상의 확률로 발생한다는 우리의 관찰을 설명합니다.
    실제로는 40%가 아니라 $4/\pi^2$이며, 사실 이 경계는 $m$의 모든 선택에 대해 유효합니다.

2.  이제 $y\in \{0,\ldots,2^m-1\}$가 다음을 만족한다고 가정해 봅시다.
    이는 $\theta$와 $y/2^m$ 사이에 $\theta$에 대한 더 나은 근사치 $z/2^m$가 있다는 것을 의미합니다.
    이번에는 $p_y$가 너무 크지 않다는 것을 증명할 것입니다.
    우리는 다음의 간단한 관찰에서 시작할 수 있습니다. 이는 단위 원의 두 점이 절대값으로 최대 $2$만큼 차이 날 수 있다는 사실에서 비롯됩니다.
    또한 위에서 호 길이와 현 길이에 대한 두 번째 관찰을 사용할 수 있으며, 이번에는 분자 대신 $p_y$의 분모를 사용하여 다음을 결론 내릴 수 있습니다.
    두 부등식을 결합하면 다음이 밝혀집니다.
    이 경계는 우리의 목적에는 충분하지만, 상당히 조악하다는 점에 유의하십시오 — 확률은 일반적으로 $1/4$보다 훨씬 낮습니다.
    이 분석에서 중요한 요점은 $\theta$에 대한 매우 가까운 근사치가 발생할 가능성이 높다는 것입니다 — 우리는 40% 이상의 확률로 최적의 $m$비트 근사치를 얻을 것입니다 — 반면 $2^{-m}$보다 더 많이 벗어난 근사치는 발생할 가능성이 적으며, 확률은 25%로 상한이 정해집니다.

이러한 보장이 주어졌을 때, $\theta$에 대한 통계적 증거를 수집하기 위해 위상 추정 절차를 여러 번 반복함으로써 신뢰도를 높일 수 있습니다.
아래쪽 큐비트 집합의 상태는 위상 추정 절차에 의해 변경되지 않으므로, 원하는 만큼 여러 번 절차를 실행하는 데 사용할 수 있다는 점에 유의하는 것이 중요합니다.
특히, 회로를 실행할 때마다 40% 이상의 확률로 $\theta$에 대한 최적의 $m$비트 근사치를 얻을 수 있으며, $2^{-m}$보다 더 많이 벗어날 확률은 25%로 제한됩니다.
만약 우리가 회로를 여러 번 실행하고 실행 결과 중 가장 흔하게 나타나는 결과를 취한다면, 가장 흔하게 나타나는 결과가 최대 25%의 시간만 발생하는 결과가 아닐 가능성이 매우 높습니다.
그 결과, 우리는 $\theta$ 값의 $1/2^m$ 이내에 있는 근사치 $y/2^m$를 얻을 가능성이 매우 높습니다.
실제로 $1/2^m$보다 더 많이 벗어날 가능성은 절차가 실행되는 횟수에 따라 기하급수적으로 감소합니다.
여기 $m=3$ 및 $m=4$일 때 $\theta$의 함수로서 $y$에 대한 세 가지 연속 값의 확률을 보여주는 두 개의 그래프가 있습니다.
(명확성을 위해 세 가지 결과만 표시됩니다. 다른 결과에 대한 확률은 동일한 기본 함수를 순환적으로 이동하여 얻어집니다.)

[이미지 설명: 세 큐비트 위상 추정에 대한 결과 확률을 보여주는 그래프]
[이미지 설명: 네 큐비트 위상 추정에 대한 결과 확률을 보여주는 그래프]
